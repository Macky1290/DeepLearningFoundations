<!DOCTYPE html>
<!-- saved from url=(0119)http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>dlnd_tv_script_generation</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://localhost:8888/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./dlnd_tv_script_generation_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./dlnd_tv_script_generation_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./dlnd_tv_script_generation_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./dlnd_tv_script_generation_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./dlnd_tv_script_generation_files/codemirror.css">


    <link rel="stylesheet" href="./dlnd_tv_script_generation_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./dlnd_tv_script_generation_files/override.css" type="text/css">
<link rel="stylesheet" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./dlnd_tv_script_generation_files/custom.css" type="text/css">
    <script src="./dlnd_tv_script_generation_files/promise.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./dlnd_tv_script_generation_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20170331222954",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
	  map: { // for backward compatibility
	    "*": {
		"jqueryui": "jquery-ui",
	    }
	  },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      define("bootstrap", function () {
          return window.$;
      });

      define("jquery", function () {
          return window.$;
      });

      define("jqueryui", function () {
          return window.$;
      });

      define("jquery-ui", function () {
          return window.$;
      });
      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./dlnd_tv_script_generation_files/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./dlnd_tv_script_generation_files/custom.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./dlnd_tv_script_generation_files/extension.js"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="notebook_app edit_mode" data-jupyter-api-token="a677429c26bd89faf91d993ba9af6881ba5eb5f3413a7591" data-base-url="/" data-ws-url="" data-notebook-name="dlnd_tv_script_generation.ipynb" data-notebook-path="GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    &lt;div id='noscript'&gt;
      Jupyter Notebook requires JavaScript.&lt;br&gt;
      Please enable it to proceed.
  &lt;/div&gt;
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://localhost:8888/tree" title="dashboard"><img src="./dlnd_tv_script_generation_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
        <button id="logout" class="btn btn-sm navbar-btn">Logout</button>
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">dlnd_tv_script_generation</span>
    <span class="checkpoint_status" title="Sun, Apr 2, 2017 1:00 AM">Last Checkpoint: a few seconds ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./dlnd_tv_script_generation_files/logo-64x64.png" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Edit Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Python 3</a></li><li class="divider"></li><li id="new-notebook-submenu-python_env"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Sunday, April 2, 2017 1:00 AM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Download as</a>
                            <ul class="dropdown-menu">
                                <li id="download_ipynb"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">reST (.rst)</a></li>
                                <li id="download_pdf"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#"> Find and Replace </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle Header</a></li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle Toolbar</a></li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Slideshow</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Reconnect</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python3"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Python 3</a></li><li id="kernel-submenu-python_env"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.5?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20170331222954"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div><div class="btn-group"><button title="show new celltoolbar selector location" class="btn btn-default">CellToolbar</button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 676px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 189px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 22px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># TV Script Generation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this project, you'll generate your own <span class="cm-link">[Simpsons]</span><span class="cm-string cm-url">(https://en.wikipedia.org/wiki/The_Simpsons)</span> TV scripts using RNNs.  You'll be using part of the <span class="cm-link">[Simpsons dataset]</span><span class="cm-string cm-url">(https://www.kaggle.com/wcukierski/the-simpsons-by-the-data)</span> of scripts from 27 seasons.  The Neural Network you'll build will generate a new TV script for a scene at <span class="cm-link">[Moe's Tavern]</span><span class="cm-string cm-url">(https://simpsonswiki.com/wiki/Moe's_Tavern)</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Get the Data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The data is already provided for you.  You'll be using a subset of the original dataset.  It consists of only the scenes in Moe's Tavern.  This doesn't include other versions of the tavern, like "Moe's Cavern", "Flaming Moe's", "Uncle Moe's Family Feed-Bag", etc..</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 189px;"></div><div class="CodeMirror-gutters" style="display: none; height: 219px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="TV-Script-Generation">TV Script Generation<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#TV-Script-Generation">¶</a></h1>
<p>In this project, you'll generate your own <a href="https://en.wikipedia.org/wiki/The_Simpsons" target="_blank">Simpsons</a> TV scripts using RNNs.  You'll be using part of the <a href="https://www.kaggle.com/wcukierski/the-simpsons-by-the-data" target="_blank">Simpsons dataset</a> of scripts from 27 seasons.  The Neural Network you'll build will generate a new TV script for a scene at <a href="https://simpsonswiki.com/wiki/Moe&#39;s_Tavern" target="_blank">Moe's Tavern</a>.</p>
<h2 id="Get-the-Data">Get the Data<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Get-the-Data">¶</a></h2>
<p>The data is already provided for you.  You'll be using a subset of the original dataset.  It consists of only the scenes in Moe's Tavern.  This doesn't include other versions of the tavern, like "Moe's Cavern", "Flaming Moe's", "Uncle Moe's Family Feed-Bag", etc..</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[1]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 30.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 515px; margin-bottom: 0px; border-right-width: 30px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 25px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">helper</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data_dir</span> = <span class="cm-string">'./data/simpsons/moes_tavern_lines.txt'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span> = <span class="cm-variable">helper</span>.<span class="cm-property">load_data</span>(<span class="cm-variable">data_dir</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Ignore notice, since we don't use it for analysing the data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span> = <span class="cm-variable">text</span>[<span class="cm-number">81</span>:]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 194px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 48px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Explore the Data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Play around with <span class="cm-comment">`view_sentence_range`</span> to view different parts of the data.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 48px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Explore-the-Data">Explore the Data<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Explore-the-Data">¶</a></h2>
<p>Play around with <code>view_sentence_range</code> to view different parts of the data.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 243.594px; left: 64.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 826px; margin-bottom: 0px; border-right-width: 30px; min-height: 385px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 59px; top: 238px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">view_sentence_range</span> = (<span class="cm-number">0</span>, <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Dataset Stats'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Roughly the number of unique words: {}'</span>.<span class="cm-property">format</span>(<span class="cm-builtin">len</span>({<span class="cm-variable">word</span>: <span class="cm-keyword">None</span> <span class="cm-keyword">for</span> <span class="cm-variable">word</span> <span class="cm-keyword">in</span> <span class="cm-variable">text</span>.<span class="cm-property">split</span>()})))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">scenes</span> = <span class="cm-variable">text</span>.<span class="cm-property">split</span>(<span class="cm-string">'\n\n'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Number of scenes: {}'</span>.<span class="cm-property">format</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">scenes</span>)))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">sentence_count_scene</span> = [<span class="cm-variable">scene</span>.<span class="cm-property">count</span>(<span class="cm-string">'\n'</span>) <span class="cm-keyword">for</span> <span class="cm-variable">scene</span> <span class="cm-keyword">in</span> <span class="cm-variable">scenes</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Average number of sentences in each scene: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">np</span>.<span class="cm-property">average</span>(<span class="cm-variable">sentence_count_scene</span>)))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">sentences</span> = [<span class="cm-variable">sentence</span> <span class="cm-keyword">for</span> <span class="cm-variable">scene</span> <span class="cm-keyword">in</span> <span class="cm-variable">scenes</span> <span class="cm-keyword">for</span> <span class="cm-variable">sentence</span> <span class="cm-keyword">in</span> <span class="cm-variable">scene</span>.<span class="cm-property">split</span>(<span class="cm-string">'\n'</span>)]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Number of lines: {}'</span>.<span class="cm-property">format</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">sentences</span>)))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">word_count_sentence</span> = [<span class="cm-builtin">len</span>(<span class="cm-variable">sentence</span>.<span class="cm-property">split</span>()) <span class="cm-keyword">for</span> <span class="cm-variable">sentence</span> <span class="cm-keyword">in</span> <span class="cm-variable">sentences</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Average number of words in each line: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">np</span>.<span class="cm-property">average</span>(<span class="cm-variable">word_count_sentence</span>)))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'The sentences {} to {}:'</span>.<span class="cm-property">format</span>(<span class="cm-operator">*</span><span class="cm-variable">view_sentence_range</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'\n'</span>.<span class="cm-property">join</span>(<span class="cm-variable">text</span>.<span class="cm-property">split</span>(<span class="cm-string">'\n'</span>)[<span class="cm-variable">view_sentence_range</span>[<span class="cm-number">0</span>]:<span class="cm-variable">view_sentence_range</span>[<span class="cm-number">1</span>]]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 385px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Dataset Stats
Roughly the number of unique words: 11492
Number of scenes: 262
Average number of sentences in each scene: 15.248091603053435
Number of lines: 4257
Average number of words in each line: 11.50434578341555

The sentences 0 to 10:
Moe_Szyslak: (INTO PHONE) Moe's Tavern. Where the elite meet to drink.
Bart_Simpson: Eh, yeah, hello, is Mike there? Last name, Rotch.
Moe_Szyslak: (INTO PHONE) Hold on, I'll check. (TO BARFLIES) Mike Rotch. Mike Rotch. Hey, has anybody seen Mike Rotch, lately?
Moe_Szyslak: (INTO PHONE) Listen you little puke. One of these days I'm gonna catch you, and I'm gonna carve my name on your back with an ice pick.
Moe_Szyslak: What's the matter Homer? You're not your normal effervescent self.
Homer_Simpson: I got my problems, Moe. Give me another one.
Moe_Szyslak: Homer, hey, you should not drink to forget your problems.
Barney_Gumble: Yeah, you should only drink to enhance your social skills.


</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 237px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Implement Preprocessing Functions</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The first thing to do to any dataset is preprocessing.  Implement the following preprocessing functions below:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Lookup Table</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Tokenize Punctuation</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Lookup Table</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To create a word embedding, you first need to transform the words to ids.  In this function, create two dictionaries:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Dictionary to go from the words to an id, we'll call <span class="cm-comment">`vocab_to_int`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Dictionary to go from the id to word, we'll call <span class="cm-comment">`int_to_vocab`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return these dictionaries in the following tuple <span class="cm-comment">`(vocab_to_int, int_to_vocab)`</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 237px;"></div><div class="CodeMirror-gutters" style="display: none; height: 267px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Implement-Preprocessing-Functions">Implement Preprocessing Functions<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Implement-Preprocessing-Functions">¶</a></h2>
<p>The first thing to do to any dataset is preprocessing.  Implement the following preprocessing functions below:</p>
<ul>
<li>Lookup Table</li>
<li>Tokenize Punctuation</li>
</ul>
<h3 id="Lookup-Table">Lookup Table<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Lookup-Table">¶</a></h3>
<p>To create a word embedding, you first need to transform the words to ids.  In this function, create two dictionaries:</p>
<ul>
<li>Dictionary to go from the words to an id, we'll call <code>vocab_to_int</code></li>
<li>Dictionary to go from the id to word, we'll call <code>int_to_vocab</code></li>
</ul>
<p>Return these dictionaries in the following tuple <code>(vocab_to_int, int_to_vocab)</code></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 226.594px; left: 316.406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 490px; margin-bottom: 0px; border-right-width: 30px; min-height: 351px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 310.812px; top: 221px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">problem_unittests</span> <span class="cm-keyword">as</span> <span class="cm-variable">tests</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">create_lookup_tables</span>(<span class="cm-variable">text</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Create lookup tables for vocabulary</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param text: The text of tv scripts split into words</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: A tuple of dicts (vocab_to_int, int_to_vocab)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">vocab</span> = <span class="cm-builtin">set</span>(<span class="cm-variable">text</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">vocab_to_int</span> = {<span class="cm-variable">ww</span>: <span class="cm-variable">ii</span> <span class="cm-keyword">for</span> <span class="cm-variable">ii</span>, <span class="cm-variable">ww</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">vocab</span>)}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">int_to_vocab</span> = <span class="cm-builtin">dict</span>(<span class="cm-builtin">enumerate</span>(<span class="cm-variable">vocab</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">vocab_to_int</span>, <span class="cm-variable">int_to_vocab</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_create_lookup_tables</span>(<span class="cm-variable">create_lookup_tables</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 351px;"></div><div class="CodeMirror-gutters" style="display: none; height: 381px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 404px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Tokenize Punctuation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We'll be splitting the script into a word array using spaces as delimiters.  However, punctuations like periods and exclamation marks make it hard for the neural network to distinguish between the word "bye" and "bye!".</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement the function <span class="cm-comment">`token_lookup`</span> to return a dict that will be used to tokenize symbols like "!" into "||Exclamation_Mark||".  Create a dictionary for the following symbols where the symbol is the key and value is the token:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Period ( . )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Comma ( , )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Quotation Mark ( " )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Semicolon ( ; )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Exclamation mark ( ! )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Question mark ( ? )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Left Parentheses ( ( )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Right Parentheses ( ) )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Dash ( -- )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Return ( \n )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This dictionary will be used to token the symbols and add the delimiter (space) around it.  This separates the symbols as it's own word, making it easier for the neural network to predict on the next word. Make sure you don't use a token that could be confused as a word. Instead of using the token "dash", try using something like "||dash||".</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 404px;"></div><div class="CodeMirror-gutters" style="display: none; height: 434px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Tokenize-Punctuation">Tokenize Punctuation<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Tokenize-Punctuation">¶</a></h3>
<p>We'll be splitting the script into a word array using spaces as delimiters.  However, punctuations like periods and exclamation marks make it hard for the neural network to distinguish between the word "bye" and "bye!".</p>
<p>Implement the function <code>token_lookup</code> to return a dict that will be used to tokenize symbols like "!" into "||Exclamation_Mark||".  Create a dictionary for the following symbols where the symbol is the key and value is the token:</p>
<ul>
<li>Period ( . )</li>
<li>Comma ( , )</li>
<li>Quotation Mark ( " )</li>
<li>Semicolon ( ; )</li>
<li>Exclamation mark ( ! )</li>
<li>Question mark ( ? )</li>
<li>Left Parentheses ( ( )</li>
<li>Right Parentheses ( ) )</li>
<li>Dash ( -- )</li>
<li>Return ( \n )</li>
</ul>
<p>This dictionary will be used to token the symbols and add the delimiter (space) around it.  This separates the symbols as it's own word, making it easier for the neural network to predict on the next word. Make sure you don't use a token that could be confused as a word. Instead of using the token "dash", try using something like "||dash||".</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 260.594px; left: 282.781px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 910.266px; margin-bottom: 0px; border-right-width: 30px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 277.188px; top: 255px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">token_lookup</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Generate a dict to turn punctuation into a token.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tokenize dictionary where the key is the punctuation and the value is the token</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">key</span> = [ <span class="cm-string">'.'</span>, <span class="cm-string">','</span>, <span class="cm-string">'"'</span>, <span class="cm-string">';'</span>, <span class="cm-string">'!'</span>, <span class="cm-string">'?'</span>, <span class="cm-string">'('</span>, <span class="cm-string">')'</span>, <span class="cm-string">'--'</span>,<span class="cm-string">'\n'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">value</span> = [ <span class="cm-string">'||Period||'</span>, <span class="cm-string">'||Comma||'</span>, <span class="cm-string">'||Quotation_Mark||'</span>, <span class="cm-string">'||Semicolon||'</span>, <span class="cm-string">'||Exclamation_mark||'</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">             <span class="cm-string">'||Question_mark||'</span>, <span class="cm-string">'||Left_parentheses||'</span>, <span class="cm-string">'||Right_parentheses||'</span>, <span class="cm-string">'||Dash||'</span>, <span class="cm-string">'||Return||'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-builtin">dict</span>(<span class="cm-builtin">zip</span>(<span class="cm-variable">key</span>, <span class="cm-variable">value</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_tokenize</span>(<span class="cm-variable">token_lookup</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 313px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 48px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Preprocess all the data and save it</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Running the code cell below will preprocess all the data and save it to file.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 48px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Preprocess-all-the-data-and-save-it">Preprocess all the data and save it<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Preprocess-all-the-data-and-save-it">¶</a></h2>
<p>Running the code cell below will preprocess all the data and save it to file.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 30.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 649.828px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 25px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Preprocess Training, Validation, and Testing Data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">helper</span>.<span class="cm-property">preprocess_and_save_data</span>(<span class="cm-variable">data_dir</span>, <span class="cm-variable">token_lookup</span>, <span class="cm-variable">create_lookup_tables</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 67px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 22px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Check Point</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This is your first checkpoint. If you ever decide to come back to this notebook or have to restart the notebook, you can start from here. The preprocessed data has been saved to disk.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 67px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Check-Point">Check Point<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Check-Point">¶</a></h1>
<p>This is your first checkpoint. If you ever decide to come back to this notebook or have to restart the notebook, you can start from here. The preprocessed data has been saved to disk.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.5938px; left: 156.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 633px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 151px; top: 68px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">helper</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">problem_unittests</span> <span class="cm-keyword">as</span> <span class="cm-variable">tests</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">int_text</span>, <span class="cm-variable">vocab_to_int</span>, <span class="cm-variable">int_to_vocab</span>, <span class="cm-variable">token_dict</span> = <span class="cm-variable">helper</span>.<span class="cm-property">load_preprocess</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 203px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Build the Neural Network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You'll build the components necessary to build a RNN by implementing the following functions below:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- get_inputs</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- get_init_cell</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- get_embed</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- build_rnn</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- build_nn</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- get_batches</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Check the Version of TensorFlow and Access to GPU</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 203px;"></div><div class="CodeMirror-gutters" style="display: none; height: 233px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Build-the-Neural-Network">Build the Neural Network<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Build-the-Neural-Network">¶</a></h2>
<p>You'll build the components necessary to build a RNN by implementing the following functions below:</p>
<ul>
<li>get_inputs</li>
<li>get_init_cell</li>
<li>get_embed</li>
<li>build_rnn</li>
<li>build_nn</li>
<li>get_batches</li>
</ul>
<h3 id="Check-the-Version-of-TensorFlow-and-Access-to-GPU">Check the Version of TensorFlow and Access to GPU<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Check-the-Version-of-TensorFlow-and-Access-to-GPU">¶</a></h3>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 209.594px; left: 282.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 876.641px; margin-bottom: 0px; border-right-width: 30px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 277px; top: 204px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">distutils</span>.<span class="cm-property">version</span> <span class="cm-keyword">import</span> <span class="cm-variable">LooseVersion</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">warnings</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Check TensorFlow Version</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-variable">LooseVersion</span>(<span class="cm-variable">tf</span>.<span class="cm-property">__version__</span>) <span class="cm-operator">&gt;</span>= <span class="cm-variable">LooseVersion</span>(<span class="cm-string">'1.0'</span>), <span class="cm-string">'Please use TensorFlow version 1.0 or newer'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'TensorFlow Version: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">tf</span>.<span class="cm-property">__version__</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Check for a GPU</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">tf</span>.<span class="cm-property">test</span>.<span class="cm-property">gpu_device_name</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">warnings</span>.<span class="cm-property">warn</span>(<span class="cm-string">'No GPU found. Please use a GPU to train your neural network.'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-string">'Default GPU Device: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">tf</span>.<span class="cm-property">test</span>.<span class="cm-property">gpu_device_name</span>()))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 313px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>TensorFlow Version: 1.0.1
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>/Users/macky123/anaconda/envs/tensorflow/lib/python3.5/site-packages/ipykernel/__main__.py:14: UserWarning: No GPU found. Please use a GPU to train your neural network.
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 166px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement the <span class="cm-comment">`get_inputs()`</span> function to create TF Placeholders for the Neural Network.  It should create the following placeholders:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Input text placeholder named "input" using the <span class="cm-link">[TF Placeholder]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/placeholder)</span> <span class="cm-comment">`name`</span> parameter.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Targets placeholder</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Learning Rate placeholder</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return the placeholders in the following the tuple <span class="cm-comment">`(Input, Targets, LearingRate)`</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 166px;"></div><div class="CodeMirror-gutters" style="display: none; height: 196px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Input">Input<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Input">¶</a></h3>
<p>Implement the <code>get_inputs()</code> function to create TF Placeholders for the Neural Network.  It should create the following placeholders:</p>
<ul>
<li>Input text placeholder named "input" using the <a href="https://www.tensorflow.org/api_docs/python/tf/placeholder" target="_blank">TF Placeholder</a> <code>name</code> parameter.</li>
<li>Targets placeholder</li>
<li>Learning Rate placeholder</li>
</ul>
<p>Return the placeholders in the following the tuple <code>(Input, Targets, LearingRate)</code></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.594px; left: 383.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 624.531px; margin-bottom: 0px; border-right-width: 30px; min-height: 300px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 378px; top: 153px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">get_inputs</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Create TF Placeholders for input, targets, and learning rate.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tuple (input, targets, learning rate)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">input</span> = <span class="cm-variable">tf</span>.<span class="cm-property">placeholder</span>(<span class="cm-variable">tf</span>.<span class="cm-property">int32</span>, <span class="cm-variable">shape</span>=[<span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>], <span class="cm-variable">name</span>=<span class="cm-string">'input'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">targets</span> = <span class="cm-variable">tf</span>.<span class="cm-property">placeholder</span>(<span class="cm-variable">tf</span>.<span class="cm-property">int32</span>, <span class="cm-variable">shape</span>=[<span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>], <span class="cm-variable">name</span>=<span class="cm-string">'targets'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">learning_rate</span> = <span class="cm-variable">tf</span>.<span class="cm-property">placeholder</span>(<span class="cm-variable">tf</span>.<span class="cm-property">float32</span>, <span class="cm-variable">name</span>=<span class="cm-string">'learning_rate'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> (<span class="cm-builtin">input</span>, <span class="cm-variable">targets</span>, <span class="cm-variable">learning_rate</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_get_inputs</span>(<span class="cm-variable">get_inputs</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 200px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Build RNN Cell and Initialize</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Stack one or more <span class="cm-link">[</span><span class="cm-link cm-comment">`BasicLSTMCells`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/BasicLSTMCell)</span> in a <span class="cm-link">[</span><span class="cm-link cm-comment">`MultiRNNCell`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/MultiRNNCell)</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The Rnn size should be set using <span class="cm-comment">`rnn_size`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Initalize Cell State using the MultiRNNCell's <span class="cm-link">[</span><span class="cm-link cm-comment">`zero_state()`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/MultiRNNCell#zero_state)</span> function</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  - Apply the name "initial_state" to the initial state using [`tf.identity()`](https://www.tensorflow.org/api_docs/python/tf/identity)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return the cell and initial state in the following tuple <span class="cm-comment">`(Cell, InitialState)`</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 200px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Build-RNN-Cell-and-Initialize">Build RNN Cell and Initialize<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Build-RNN-Cell-and-Initialize">¶</a></h3>
<p>Stack one or more <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/BasicLSTMCell" target="_blank"><code>BasicLSTMCells</code></a> in a <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/MultiRNNCell" target="_blank"><code>MultiRNNCell</code></a>.</p>
<ul>
<li>The Rnn size should be set using <code>rnn_size</code></li>
<li>Initalize Cell State using the MultiRNNCell's <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/rnn/MultiRNNCell#zero_state" target="_blank"><code>zero_state()</code></a> function<ul>
<li>Apply the name "initial_state" to the initial state using <a href="https://www.tensorflow.org/api_docs/python/tf/identity" target="_blank"><code>tf.identity()</code></a></li>
</ul>
</li>
</ul>
<p>Return the cell and initial state in the following tuple <code>(Cell, InitialState)</code></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[114]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.594px; left: 165.188px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 574.172px; margin-bottom: 0px; border-right-width: 30px; min-height: 385px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 159.594px; top: 153px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">get_init_cell</span>(<span class="cm-variable">batch_size</span>, <span class="cm-variable">rnn_size</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Create an RNN Cell and initialize it.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param batch_size: Size of batches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param rnn_size: Size of RNNs</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tuple (cell, initialize state)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">lstm</span> = <span class="cm-variable">tf</span>.<span class="cm-property">contrib</span>.<span class="cm-property">rnn</span>.<span class="cm-property">BasicLSTMCell</span>(<span class="cm-variable">rnn_size</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">lstm_layers</span> = <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cell</span> = <span class="cm-variable">tf</span>.<span class="cm-property">contrib</span>.<span class="cm-property">rnn</span>.<span class="cm-property">MultiRNNCell</span>([<span class="cm-variable">lstm</span>] <span class="cm-operator">*</span> <span class="cm-variable">lstm_layers</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">initial_state</span> = <span class="cm-variable">cell</span>.<span class="cm-property">zero_state</span>(<span class="cm-variable">batch_size</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">initial_state</span> = <span class="cm-variable">tf</span>.<span class="cm-property">identity</span>(<span class="cm-variable">initial_state</span>, <span class="cm-variable">name</span>=<span class="cm-string">'initial_state'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">cell</span>, <span class="cm-variable">initial_state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_get_init_cell</span>(<span class="cm-variable">get_init_cell</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 385px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 47px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Word Embedding</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Apply embedding to <span class="cm-comment">`input_data`</span> using TensorFlow.  Return the embedded sequence.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 47px;"></div><div class="CodeMirror-gutters" style="display: none; height: 77px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Word-Embedding">Word Embedding<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Word-Embedding">¶</a></h3>
<p>Apply embedding to <code>input_data</code> using TensorFlow.  Return the embedded sequence.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[115]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 240.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 717px; margin-bottom: 0px; border-right-width: 30px; min-height: 317px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 235px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">get_embed</span>(<span class="cm-variable">input_data</span>, <span class="cm-variable">vocab_size</span>, <span class="cm-variable">embed_dim</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Create embedding for &lt;input_data&gt;.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param input_data: TF placeholder for text input.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param vocab_size: Number of words in vocabulary.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param embed_dim: Number of embedding dimensions</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Embedded input.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">embedding</span> = <span class="cm-variable">tf</span>.<span class="cm-property">Variable</span>(<span class="cm-variable">tf</span>.<span class="cm-property">truncated_normal</span>([<span class="cm-variable">vocab_size</span>, <span class="cm-variable">embed_dim</span>], <span class="cm-variable">stddev</span>=<span class="cm-number">0.1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">embed</span> = <span class="cm-variable">tf</span>.<span class="cm-property">nn</span>.<span class="cm-property">embedding_lookup</span>(<span class="cm-variable">embedding</span>, <span class="cm-variable">input_data</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">embed</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_get_embed</span>(<span class="cm-variable">get_embed</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 317px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 166px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Build RNN</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You created a RNN Cell in the <span class="cm-comment">`get_init_cell()`</span> function.  Time to use the cell to create a RNN.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Build the RNN using the <span class="cm-link">[</span><span class="cm-link cm-comment">`tf.nn.dynamic_rnn()`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/nn/dynamic_rnn)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> - Apply the name "final_state" to the final state using <span class="cm-link">[</span><span class="cm-link cm-comment">`tf.identity()`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/identity)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return the outputs and final_state state in the following tuple <span class="cm-comment">`(Outputs, FinalState)`</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 166px;"></div><div class="CodeMirror-gutters" style="display: none; height: 196px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Build-RNN">Build RNN<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Build-RNN">¶</a></h3>
<p>You created a RNN Cell in the <code>get_init_cell()</code> function.  Time to use the cell to create a RNN.</p>
<ul>
<li>Build the RNN using the <a href="https://www.tensorflow.org/api_docs/python/tf/nn/dynamic_rnn" target="_blank"><code>tf.nn.dynamic_rnn()</code></a><ul>
<li>Apply the name "final_state" to the final state using <a href="https://www.tensorflow.org/api_docs/python/tf/identity" target="_blank"><code>tf.identity()</code></a></li>
</ul>
</li>
</ul>
<p>Return the outputs and final_state state in the following tuple <code>(Outputs, FinalState)</code> </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[116]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.594px; left: 223.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 641.328px; margin-bottom: 0px; border-right-width: 30px; min-height: 300px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 218px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">build_rnn</span>(<span class="cm-variable">cell</span>, <span class="cm-variable">inputs</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Create a RNN using a RNN Cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param cell: RNN Cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param inputs: Input text data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tuple (Outputs, Final State)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">outputs</span>, <span class="cm-variable">final_state</span> = <span class="cm-variable">tf</span>.<span class="cm-property">nn</span>.<span class="cm-property">dynamic_rnn</span>(<span class="cm-variable">cell</span>, <span class="cm-variable">inputs</span>, <span class="cm-variable">dtype</span>=<span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">final_state</span> = <span class="cm-variable">tf</span>.<span class="cm-property">identity</span>(<span class="cm-variable">final_state</span>, <span class="cm-variable">name</span>=<span class="cm-string">'final_state'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">outputs</span>, <span class="cm-variable">final_state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_build_rnn</span>(<span class="cm-variable">build_rnn</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 166px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Build the Neural Network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Apply the functions you implemented above to:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Apply embedding to <span class="cm-comment">`input_data`</span> using your <span class="cm-comment">`get_embed(input_data, vocab_size, embed_dim)`</span> function.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Build RNN using <span class="cm-comment">`cell`</span> and your <span class="cm-comment">`build_rnn(cell, inputs)`</span> function.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Apply a fully connected layer with a linear activation and <span class="cm-comment">`vocab_size`</span> as the number of outputs.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return the logits and final state in the following tuple (Logits, FinalState) </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 166px;"></div><div class="CodeMirror-gutters" style="display: none; height: 196px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Build-the-Neural-Network">Build the Neural Network<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Build-the-Neural-Network">¶</a></h3>
<p>Apply the functions you implemented above to:</p>
<ul>
<li>Apply embedding to <code>input_data</code> using your <code>get_embed(input_data, vocab_size, embed_dim)</code> function.</li>
<li>Build RNN using <code>cell</code> and your <code>build_rnn(cell, inputs)</code> function.</li>
<li>Apply a fully connected layer with a linear activation and <code>vocab_size</code> as the number of outputs.</li>
</ul>
<p>Return the logits and final state in the following tuple (Logits, FinalState) </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[117]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 260.594px; left: 223.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 733.75px; margin-bottom: 0px; border-right-width: 30px; min-height: 385px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 218px; top: 255px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">build_nn</span>(<span class="cm-variable">cell</span>, <span class="cm-variable">rnn_size</span>, <span class="cm-variable">input_data</span>, <span class="cm-variable">vocab_size</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Build part of the neural network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param cell: RNN cell</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param rnn_size: Size of rnns</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param input_data: Input data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param vocab_size: Vocabulary size</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tuple (Logits, FinalState)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">embed</span> = <span class="cm-variable">get_embed</span>(<span class="cm-variable">input_data</span>, <span class="cm-variable">vocab_size</span>, <span class="cm-variable">rnn_size</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">outputs</span>, <span class="cm-variable">final_state</span> = <span class="cm-variable">build_rnn</span>(<span class="cm-variable">cell</span>, <span class="cm-variable">embed</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">logits</span> = <span class="cm-variable">tf</span>.<span class="cm-property">contrib</span>.<span class="cm-property">layers</span>.<span class="cm-property">fully_connected</span>(<span class="cm-variable">outputs</span>, <span class="cm-variable">vocab_size</span>, <span class="cm-variable">activation_fn</span>=<span class="cm-keyword">None</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">logits</span>, <span class="cm-variable">final_state</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_build_nn</span>(<span class="cm-variable">build_nn</span>)</span></pre><pre class=" CodeMirror-line " style="display: none;"><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 385px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 557px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Batches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement <span class="cm-comment">`get_batches`</span> to create batches of input and targets using <span class="cm-comment">`int_text`</span>.  The batches should be a Numpy array with the shape <span class="cm-comment">`(number of batches, 2, batch size, sequence length)`</span>. Each batch contains two elements:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The first element is a single batch of <span class="cm-strong">**input**</span> with the shape <span class="cm-comment">`[batch size, sequence length]`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- The second element is a single batch of <span class="cm-strong">**targets**</span> with the shape <span class="cm-comment">`[batch size, sequence length]`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If you can't fill the last batch with enough data, drop the last batch.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">For exmple, <span class="cm-comment">`get_batches([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 2, 3)`</span> would return a Numpy array of the following:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">[</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment"># First Batch</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">[</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># Batch of Input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">[[ 1  2  3], [ 7  8  9]],</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># Batch of targets</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">[[ 2  3  4], [ 8  9 10]]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">],</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment"># Second Batch</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">[</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># Batch of Input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">[[ 4  5  6], [10 11 12]],</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># Batch of targets</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">[[ 5  6  7], [11 12 13]]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 557px;"></div><div class="CodeMirror-gutters" style="display: none; height: 587px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Batches">Batches<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Batches">¶</a></h3>
<p>Implement <code>get_batches</code> to create batches of input and targets using <code>int_text</code>.  The batches should be a Numpy array with the shape <code>(number of batches, 2, batch size, sequence length)</code>. Each batch contains two elements:</p>
<ul>
<li>The first element is a single batch of <strong>input</strong> with the shape <code>[batch size, sequence length]</code></li>
<li>The second element is a single batch of <strong>targets</strong> with the shape <code>[batch size, sequence length]</code></li>
</ul>
<p>If you can't fill the last batch with enough data, drop the last batch.</p>
<p>For exmple, <code>get_batches([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 2, 3)</code> would return a Numpy array of the following:</p>
<pre><code>[
  # First Batch
  [
    # Batch of Input
    [[ 1  2  3], [ 7  8  9]],
    # Batch of targets
    [[ 2  3  4], [ 8  9 10]]
  ],

  # Second Batch
  [
    # Batch of Input
    [[ 4  5  6], [10 11 12]],
    # Batch of targets
    [[ 5  6  7], [11 12 13]]
  ]
]
</code></pre></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[118]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 243.594px; left: 223.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 683.344px; margin-bottom: 0px; border-right-width: 30px; min-height: 453px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 218px; top: 238px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">get_batches</span>(<span class="cm-variable">int_text</span>, <span class="cm-variable">batch_size</span>, <span class="cm-variable">seq_length</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Return batches of input and target</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param int_text: Text with the words replaced by their ids</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param batch_size: The size of batch</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param seq_length: The length of sequence</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Batches as a Numpy array</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">n_batches</span> = <span class="cm-builtin">len</span>(<span class="cm-variable">int_text</span>)<span class="cm-operator">//</span>(<span class="cm-variable">batch_size</span><span class="cm-operator">*</span> <span class="cm-variable">seq_length</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">int_text</span> = <span class="cm-variable">int_text</span>[:<span class="cm-variable">n_batches</span><span class="cm-operator">*</span><span class="cm-variable">batch_size</span><span class="cm-operator">*</span><span class="cm-variable">seq_length</span><span class="cm-operator">+</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">batches</span> = <span class="cm-variable">np</span>.<span class="cm-property">ndarray</span>(<span class="cm-variable">shape</span>=(<span class="cm-variable">n_batches</span>, <span class="cm-number">2</span>, <span class="cm-variable">batch_size</span>, <span class="cm-variable">seq_length</span>), <span class="cm-variable">dtype</span>=<span class="cm-builtin">int</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n_batches</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">batch_size</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">length</span> = <span class="cm-variable">i</span><span class="cm-operator">*</span><span class="cm-variable">j</span><span class="cm-operator">*</span><span class="cm-variable">seq_length</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">batches</span>[<span class="cm-variable">i</span>][<span class="cm-number">0</span>][<span class="cm-variable">j</span>] = <span class="cm-variable">int_text</span>[<span class="cm-variable">length</span>:<span class="cm-variable">length</span><span class="cm-operator">+</span><span class="cm-variable">seq_length</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">batches</span>[<span class="cm-variable">i</span>][<span class="cm-number">1</span>][<span class="cm-variable">j</span>] = <span class="cm-variable">int_text</span>[<span class="cm-variable">length</span><span class="cm-operator">+</span><span class="cm-number">1</span>:<span class="cm-variable">length</span><span class="cm-operator">+</span><span class="cm-variable">seq_length</span><span class="cm-operator">+</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">batches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_get_batches</span>(<span class="cm-variable">get_batches</span>)</span></pre><pre class=" CodeMirror-line " style="display: none;"><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 453px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 203px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Neural Network Training</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Hyperparameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Tune the following parameters:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`num_epochs`</span><span class="cm-variable-2"> to the number of epochs.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`batch_size`</span><span class="cm-variable-2"> to the batch size.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`rnn_size`</span><span class="cm-variable-2"> to the size of the RNNs.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`seq_length`</span><span class="cm-variable-2"> to the length of sequence.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`learning_rate`</span><span class="cm-variable-2"> to the learning rate.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Set </span><span class="cm-comment cm-variable-2">`show_every_n_batches`</span><span class="cm-variable-2"> to the number of batches the neural network should print progress.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 203px;"></div><div class="CodeMirror-gutters" style="display: none; height: 233px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Neural-Network-Training">Neural Network Training<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Neural-Network-Training">¶</a></h2>
<h3 id="Hyperparameters">Hyperparameters<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Hyperparameters">¶</a></h3>
<p>Tune the following parameters:</p>
<ul>
<li>Set <code>num_epochs</code> to the number of epochs.</li>
<li>Set <code>batch_size</code> to the batch size.</li>
<li>Set <code>rnn_size</code> to the size of the RNNs.</li>
<li>Set <code>seq_length</code> to the length of sequence.</li>
<li>Set <code>learning_rate</code> to the learning rate.</li>
<li>Set <code>show_every_n_batches</code> to the number of batches the neural network should print progress.</li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[196]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 192.594px; left: 207.203px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 490px; margin-bottom: 0px; border-right-width: 30px; min-height: 300px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 201.609px; top: 187px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Number of Epochs</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">num_epochs</span> = <span class="cm-number">30</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Batch Size</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">batch_size</span> = <span class="cm-number">64</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># RNN Size</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">rnn_size</span> = <span class="cm-number">512</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Sequence Length</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">seq_length</span> = <span class="cm-number">20</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Learning Rate</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">learning_rate</span> = <span class="cm-number">0.005</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Show stats for every n number of batches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">show_every_n_batches</span> = <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">save_dir</span> = <span class="cm-string">'./save'</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 47px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Build the Graph</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Build the graph using the neural network you implemented.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 47px;"></div><div class="CodeMirror-gutters" style="display: none; height: 77px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Build-the-Graph">Build the Graph<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Build-the-Graph">¶</a></h3>
<p>Build the graph using the neural network you implemented.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[197]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 209.594px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 758.938px; margin-bottom: 0px; border-right-width: 30px; min-height: 504px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 204px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">contrib</span> <span class="cm-keyword">import</span> <span class="cm-variable">seq2seq</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train_graph</span> = <span class="cm-variable">tf</span>.<span class="cm-property">Graph</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">train_graph</span>.<span class="cm-property">as_default</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span> = <span class="cm-builtin">len</span>(<span class="cm-variable">int_to_vocab</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">input_text</span>, <span class="cm-variable">targets</span>, <span class="cm-variable">lr</span> = <span class="cm-variable">get_inputs</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">input_data_shape</span> = <span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">input_text</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cell</span>, <span class="cm-variable">initial_state</span> = <span class="cm-variable">get_init_cell</span>(<span class="cm-variable">input_data_shape</span>[<span class="cm-number">0</span>], <span class="cm-variable">rnn_size</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">logits</span>, <span class="cm-variable">final_state</span> = <span class="cm-variable">build_nn</span>(<span class="cm-variable">cell</span>, <span class="cm-variable">rnn_size</span>, <span class="cm-variable">input_text</span>, <span class="cm-variable">vocab_size</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Probabilities for generating words</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">probs</span> = <span class="cm-variable">tf</span>.<span class="cm-property">nn</span>.<span class="cm-property">softmax</span>(<span class="cm-variable">logits</span>, <span class="cm-variable">name</span>=<span class="cm-string">'probs'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Loss function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cost</span> = <span class="cm-variable">seq2seq</span>.<span class="cm-property">sequence_loss</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">logits</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">targets</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">tf</span>.<span class="cm-property">ones</span>([<span class="cm-variable">input_data_shape</span>[<span class="cm-number">0</span>], <span class="cm-variable">input_data_shape</span>[<span class="cm-number">1</span>]]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Optimizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">optimizer</span> = <span class="cm-variable">tf</span>.<span class="cm-property">train</span>.<span class="cm-property">AdamOptimizer</span>(<span class="cm-variable">lr</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Gradient Clipping</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = <span class="cm-variable">optimizer</span>.<span class="cm-property">compute_gradients</span>(<span class="cm-variable">cost</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">capped_gradients</span> = [(<span class="cm-variable">tf</span>.<span class="cm-property">clip_by_value</span>(<span class="cm-variable">grad</span>, <span class="cm-operator">-</span><span class="cm-number">1.</span>, <span class="cm-number">1.</span>), <span class="cm-variable">var</span>) <span class="cm-keyword">for</span> <span class="cm-variable">grad</span>, <span class="cm-variable">var</span> <span class="cm-keyword">in</span> <span class="cm-variable">gradients</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">train_op</span> = <span class="cm-variable">optimizer</span>.<span class="cm-property">apply_gradients</span>(<span class="cm-variable">capped_gradients</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 504px;"></div><div class="CodeMirror-gutters" style="display: none; height: 534px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 82px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Train</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Train the neural network on the preprocessed data.  If you have a hard time getting a good loss, check the <span class="cm-link">[forms]</span><span class="cm-string cm-url">(https://discussions.udacity.com/)</span> to see if anyone is having the same problem.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 82px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Train">Train<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Train">¶</a></h2>
<p>Train the neural network on the preprocessed data.  If you have a hard time getting a good loss, check the <a href="https://discussions.udacity.com/" target="_blank">forms</a> to see if anyone is having the same problem.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[198]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 294.594px; left: 232.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 674.969px; margin-bottom: 0px; border-right-width: 30px; min-height: 538px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 227px; top: 289px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">batches</span> = <span class="cm-variable">get_batches</span>(<span class="cm-variable">int_text</span>, <span class="cm-variable">batch_size</span>, <span class="cm-variable">seq_length</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">tf</span>.<span class="cm-property">Session</span>(<span class="cm-variable">graph</span>=<span class="cm-variable">train_graph</span>) <span class="cm-keyword">as</span> <span class="cm-variable">sess</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable">tf</span>.<span class="cm-property">global_variables_initializer</span>())</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">epoch_i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">num_epochs</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">state</span> = <span class="cm-variable">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable">initial_state</span>, {<span class="cm-variable">input_text</span>: <span class="cm-variable">batches</span>[<span class="cm-number">0</span>][<span class="cm-number">0</span>]})</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">batch_i</span>, (<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">batches</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">feed</span> = {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">input_text</span>: <span class="cm-variable">x</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">targets</span>: <span class="cm-variable">y</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">initial_state</span>: <span class="cm-variable">state</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-variable">lr</span>: <span class="cm-variable">learning_rate</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">train_loss</span>, <span class="cm-variable">state</span>, <span class="cm-variable">_</span> = <span class="cm-variable">sess</span>.<span class="cm-property">run</span>([<span class="cm-variable">cost</span>, <span class="cm-variable">final_state</span>, <span class="cm-variable">train_op</span>], <span class="cm-variable">feed</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-comment"># Show every &lt;show_every_n_batches&gt; batches</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-keyword">if</span> (<span class="cm-variable">epoch_i</span> <span class="cm-operator">*</span> <span class="cm-builtin">len</span>(<span class="cm-variable">batches</span>) <span class="cm-operator">+</span> <span class="cm-variable">batch_i</span>) <span class="cm-operator">%</span> <span class="cm-variable">show_every_n_batches</span> == <span class="cm-number">0</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-builtin">print</span>(<span class="cm-string">'Epoch {:&gt;3} Batch {:&gt;4}/{}   train_loss = {:.3f}'</span>.<span class="cm-property">format</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                    <span class="cm-variable">epoch_i</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                    <span class="cm-variable">batch_i</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                    <span class="cm-builtin">len</span>(<span class="cm-variable">batches</span>),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                    <span class="cm-variable">train_loss</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Save Model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">saver</span> = <span class="cm-variable">tf</span>.<span class="cm-property">train</span>.<span class="cm-property">Saver</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">saver</span>.<span class="cm-property">save</span>(<span class="cm-variable">sess</span>, <span class="cm-variable">save_dir</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-string">'Model Trained and Saved'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 538px;"></div><div class="CodeMirror-gutters" style="display: none; height: 568px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to unscroll output; double click to hide" style=""></div><div class="output output_scroll" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Epoch   0 Batch    0/53   train_loss = 8.821
Epoch   0 Batch    1/53   train_loss = 8.802
Epoch   0 Batch    2/53   train_loss = 7.492
Epoch   0 Batch    3/53   train_loss = 6.435
Epoch   0 Batch    4/53   train_loss = 6.068
Epoch   0 Batch    5/53   train_loss = 6.433
Epoch   0 Batch    6/53   train_loss = 6.128
Epoch   0 Batch    7/53   train_loss = 6.652
Epoch   0 Batch    8/53   train_loss = 6.411
Epoch   0 Batch    9/53   train_loss = 6.188
Epoch   0 Batch   10/53   train_loss = 6.274
Epoch   0 Batch   11/53   train_loss = 6.855
Epoch   0 Batch   12/53   train_loss = 6.346
Epoch   0 Batch   13/53   train_loss = 6.774
Epoch   0 Batch   14/53   train_loss = 6.525
Epoch   0 Batch   15/53   train_loss = 6.526
Epoch   0 Batch   16/53   train_loss = 6.591
Epoch   0 Batch   17/53   train_loss = 6.962
Epoch   0 Batch   18/53   train_loss = 6.423
Epoch   0 Batch   19/53   train_loss = 6.763
Epoch   0 Batch   20/53   train_loss = 6.291
Epoch   0 Batch   21/53   train_loss = 6.420
Epoch   0 Batch   22/53   train_loss = 6.582
Epoch   0 Batch   23/53   train_loss = 6.885
Epoch   0 Batch   24/53   train_loss = 6.298
Epoch   0 Batch   25/53   train_loss = 6.677
Epoch   0 Batch   26/53   train_loss = 6.420
Epoch   0 Batch   27/53   train_loss = 6.306
Epoch   0 Batch   28/53   train_loss = 6.257
Epoch   0 Batch   29/53   train_loss = 6.524
Epoch   0 Batch   30/53   train_loss = 6.400
Epoch   0 Batch   31/53   train_loss = 6.743
Epoch   0 Batch   32/53   train_loss = 6.405
Epoch   0 Batch   33/53   train_loss = 6.397
Epoch   0 Batch   34/53   train_loss = 6.330
Epoch   0 Batch   35/53   train_loss = 6.568
Epoch   0 Batch   36/53   train_loss = 6.298
Epoch   0 Batch   37/53   train_loss = 6.532
Epoch   0 Batch   38/53   train_loss = 6.386
Epoch   0 Batch   39/53   train_loss = 6.518
Epoch   0 Batch   40/53   train_loss = 6.251
Epoch   0 Batch   41/53   train_loss = 6.752
Epoch   0 Batch   42/53   train_loss = 6.147
Epoch   0 Batch   43/53   train_loss = 6.673
Epoch   0 Batch   44/53   train_loss = 6.247
Epoch   0 Batch   45/53   train_loss = 6.310
Epoch   0 Batch   46/53   train_loss = 6.754
Epoch   0 Batch   47/53   train_loss = 6.568
Epoch   0 Batch   48/53   train_loss = 6.186
Epoch   0 Batch   49/53   train_loss = 6.384
Epoch   0 Batch   50/53   train_loss = 6.401
Epoch   0 Batch   51/53   train_loss = 6.462
Epoch   0 Batch   52/53   train_loss = 6.185
Epoch   1 Batch    0/53   train_loss = 5.272
Epoch   1 Batch    1/53   train_loss = 6.016
Epoch   1 Batch    2/53   train_loss = 5.948
Epoch   1 Batch    3/53   train_loss = 6.052
Epoch   1 Batch    4/53   train_loss = 5.894
Epoch   1 Batch    5/53   train_loss = 6.050
Epoch   1 Batch    6/53   train_loss = 5.727
Epoch   1 Batch    7/53   train_loss = 6.022
Epoch   1 Batch    8/53   train_loss = 5.935
Epoch   1 Batch    9/53   train_loss = 5.810
Epoch   1 Batch   10/53   train_loss = 5.840
Epoch   1 Batch   11/53   train_loss = 6.243
Epoch   1 Batch   12/53   train_loss = 5.789
Epoch   1 Batch   13/53   train_loss = 6.138
Epoch   1 Batch   14/53   train_loss = 5.938
Epoch   1 Batch   15/53   train_loss = 6.015
Epoch   1 Batch   16/53   train_loss = 6.045
Epoch   1 Batch   17/53   train_loss = 6.258
Epoch   1 Batch   18/53   train_loss = 5.922
Epoch   1 Batch   19/53   train_loss = 6.171
Epoch   1 Batch   20/53   train_loss = 5.827
Epoch   1 Batch   21/53   train_loss = 5.921
Epoch   1 Batch   22/53   train_loss = 6.065
Epoch   1 Batch   23/53   train_loss = 6.275
Epoch   1 Batch   24/53   train_loss = 5.847
Epoch   1 Batch   25/53   train_loss = 6.106
Epoch   1 Batch   26/53   train_loss = 5.966
Epoch   1 Batch   27/53   train_loss = 5.931
Epoch   1 Batch   28/53   train_loss = 5.931
Epoch   1 Batch   29/53   train_loss = 6.043
Epoch   1 Batch   30/53   train_loss = 6.050
Epoch   1 Batch   31/53   train_loss = 6.296
Epoch   1 Batch   32/53   train_loss = 5.971
Epoch   1 Batch   33/53   train_loss = 5.975
Epoch   1 Batch   34/53   train_loss = 6.025
Epoch   1 Batch   35/53   train_loss = 6.166
Epoch   1 Batch   36/53   train_loss = 5.948
Epoch   1 Batch   37/53   train_loss = 6.070
Epoch   1 Batch   38/53   train_loss = 6.051
Epoch   1 Batch   39/53   train_loss = 6.069
Epoch   1 Batch   40/53   train_loss = 5.976
Epoch   1 Batch   41/53   train_loss = 6.274
Epoch   1 Batch   42/53   train_loss = 5.957
Epoch   1 Batch   43/53   train_loss = 6.258
Epoch   1 Batch   44/53   train_loss = 5.890
Epoch   1 Batch   45/53   train_loss = 6.026
Epoch   1 Batch   46/53   train_loss = 6.284
Epoch   1 Batch   47/53   train_loss = 6.226
Epoch   1 Batch   48/53   train_loss = 5.916
Epoch   1 Batch   49/53   train_loss = 6.060
Epoch   1 Batch   50/53   train_loss = 6.170
Epoch   1 Batch   51/53   train_loss = 6.202
Epoch   1 Batch   52/53   train_loss = 5.947
Epoch   2 Batch    0/53   train_loss = 5.062
Epoch   2 Batch    1/53   train_loss = 5.949
Epoch   2 Batch    2/53   train_loss = 5.889
Epoch   2 Batch    3/53   train_loss = 5.959
Epoch   2 Batch    4/53   train_loss = 5.792
Epoch   2 Batch    5/53   train_loss = 5.935
Epoch   2 Batch    6/53   train_loss = 5.663
Epoch   2 Batch    7/53   train_loss = 5.917
Epoch   2 Batch    8/53   train_loss = 5.790
Epoch   2 Batch    9/53   train_loss = 5.695
Epoch   2 Batch   10/53   train_loss = 5.709
Epoch   2 Batch   11/53   train_loss = 6.045
Epoch   2 Batch   12/53   train_loss = 5.572
Epoch   2 Batch   13/53   train_loss = 5.929
Epoch   2 Batch   14/53   train_loss = 5.720
Epoch   2 Batch   15/53   train_loss = 5.818
Epoch   2 Batch   16/53   train_loss = 5.813
Epoch   2 Batch   17/53   train_loss = 6.071
Epoch   2 Batch   18/53   train_loss = 5.694
Epoch   2 Batch   19/53   train_loss = 5.967
Epoch   2 Batch   20/53   train_loss = 5.649
Epoch   2 Batch   21/53   train_loss = 5.726
Epoch   2 Batch   22/53   train_loss = 5.819
Epoch   2 Batch   23/53   train_loss = 6.063
Epoch   2 Batch   24/53   train_loss = 5.666
Epoch   2 Batch   25/53   train_loss = 5.891
Epoch   2 Batch   26/53   train_loss = 5.746
Epoch   2 Batch   27/53   train_loss = 5.757
Epoch   2 Batch   28/53   train_loss = 5.723
Epoch   2 Batch   29/53   train_loss = 5.828
Epoch   2 Batch   30/53   train_loss = 5.797
Epoch   2 Batch   31/53   train_loss = 6.038
Epoch   2 Batch   32/53   train_loss = 5.770
Epoch   2 Batch   33/53   train_loss = 5.760
Epoch   2 Batch   34/53   train_loss = 5.814
Epoch   2 Batch   35/53   train_loss = 5.934
Epoch   2 Batch   36/53   train_loss = 5.758
Epoch   2 Batch   37/53   train_loss = 5.908
Epoch   2 Batch   38/53   train_loss = 5.892
Epoch   2 Batch   39/53   train_loss = 5.864
Epoch   2 Batch   40/53   train_loss = 5.793
Epoch   2 Batch   41/53   train_loss = 6.124
Epoch   2 Batch   42/53   train_loss = 5.772
Epoch   2 Batch   43/53   train_loss = 6.114
Epoch   2 Batch   44/53   train_loss = 5.757
Epoch   2 Batch   45/53   train_loss = 5.871
Epoch   2 Batch   46/53   train_loss = 6.118
Epoch   2 Batch   47/53   train_loss = 6.071
Epoch   2 Batch   48/53   train_loss = 5.736
Epoch   2 Batch   49/53   train_loss = 5.904
Epoch   2 Batch   50/53   train_loss = 5.971
Epoch   2 Batch   51/53   train_loss = 6.005
Epoch   2 Batch   52/53   train_loss = 5.716
Epoch   3 Batch    0/53   train_loss = 4.908
Epoch   3 Batch    1/53   train_loss = 5.787
Epoch   3 Batch    2/53   train_loss = 5.741
Epoch   3 Batch    3/53   train_loss = 5.775
Epoch   3 Batch    4/53   train_loss = 5.643
Epoch   3 Batch    5/53   train_loss = 5.706
Epoch   3 Batch    6/53   train_loss = 5.476
Epoch   3 Batch    7/53   train_loss = 5.730
Epoch   3 Batch    8/53   train_loss = 5.616
Epoch   3 Batch    9/53   train_loss = 5.507
Epoch   3 Batch   10/53   train_loss = 5.537
Epoch   3 Batch   11/53   train_loss = 5.751
Epoch   3 Batch   12/53   train_loss = 5.332
Epoch   3 Batch   13/53   train_loss = 5.656
Epoch   3 Batch   14/53   train_loss = 5.473
Epoch   3 Batch   15/53   train_loss = 5.492
Epoch   3 Batch   16/53   train_loss = 5.446
Epoch   3 Batch   17/53   train_loss = 5.692
Epoch   3 Batch   18/53   train_loss = 5.377
Epoch   3 Batch   19/53   train_loss = 5.575
Epoch   3 Batch   20/53   train_loss = 5.263
Epoch   3 Batch   21/53   train_loss = 5.350
Epoch   3 Batch   22/53   train_loss = 5.421
Epoch   3 Batch   23/53   train_loss = 5.582
Epoch   3 Batch   24/53   train_loss = 5.218
Epoch   3 Batch   25/53   train_loss = 5.435
Epoch   3 Batch   26/53   train_loss = 5.275
Epoch   3 Batch   27/53   train_loss = 5.292
Epoch   3 Batch   28/53   train_loss = 5.283
Epoch   3 Batch   29/53   train_loss = 5.403
Epoch   3 Batch   30/53   train_loss = 5.291
Epoch   3 Batch   31/53   train_loss = 5.607
Epoch   3 Batch   32/53   train_loss = 5.213
Epoch   3 Batch   33/53   train_loss = 5.275
Epoch   3 Batch   34/53   train_loss = 5.291
Epoch   3 Batch   35/53   train_loss = 5.405
Epoch   3 Batch   36/53   train_loss = 5.171
Epoch   3 Batch   37/53   train_loss = 5.349
Epoch   3 Batch   38/53   train_loss = 5.340
Epoch   3 Batch   39/53   train_loss = 5.266
Epoch   3 Batch   40/53   train_loss = 5.153
Epoch   3 Batch   41/53   train_loss = 5.589
Epoch   3 Batch   42/53   train_loss = 5.153
Epoch   3 Batch   43/53   train_loss = 5.545
Epoch   3 Batch   44/53   train_loss = 5.094
Epoch   3 Batch   45/53   train_loss = 5.201
Epoch   3 Batch   46/53   train_loss = 5.417
Epoch   3 Batch   47/53   train_loss = 5.472
Epoch   3 Batch   48/53   train_loss = 5.055
Epoch   3 Batch   49/53   train_loss = 5.284
Epoch   3 Batch   50/53   train_loss = 5.292
Epoch   3 Batch   51/53   train_loss = 5.281
Epoch   3 Batch   52/53   train_loss = 5.111
Epoch   4 Batch    0/53   train_loss = 3.987
Epoch   4 Batch    1/53   train_loss = 5.130
Epoch   4 Batch    2/53   train_loss = 4.993
Epoch   4 Batch    3/53   train_loss = 4.974
Epoch   4 Batch    4/53   train_loss = 4.820
Epoch   4 Batch    5/53   train_loss = 4.859
Epoch   4 Batch    6/53   train_loss = 4.609
Epoch   4 Batch    7/53   train_loss = 4.971
Epoch   4 Batch    8/53   train_loss = 4.823
Epoch   4 Batch    9/53   train_loss = 4.755
Epoch   4 Batch   10/53   train_loss = 4.785
Epoch   4 Batch   11/53   train_loss = 5.104
Epoch   4 Batch   12/53   train_loss = 4.573
Epoch   4 Batch   13/53   train_loss = 4.980
Epoch   4 Batch   14/53   train_loss = 4.839
Epoch   4 Batch   15/53   train_loss = 4.777
Epoch   4 Batch   16/53   train_loss = 4.722
Epoch   4 Batch   17/53   train_loss = 4.998
Epoch   4 Batch   18/53   train_loss = 4.617
Epoch   4 Batch   19/53   train_loss = 5.007
Epoch   4 Batch   20/53   train_loss = 4.557
Epoch   4 Batch   21/53   train_loss = 4.738
Epoch   4 Batch   22/53   train_loss = 4.792
Epoch   4 Batch   23/53   train_loss = 5.010
Epoch   4 Batch   24/53   train_loss = 4.560
Epoch   4 Batch   25/53   train_loss = 4.837
Epoch   4 Batch   26/53   train_loss = 4.660
Epoch   4 Batch   27/53   train_loss = 4.749
Epoch   4 Batch   28/53   train_loss = 4.679
Epoch   4 Batch   29/53   train_loss = 4.873
Epoch   4 Batch   30/53   train_loss = 4.586
Epoch   4 Batch   31/53   train_loss = 5.051
Epoch   4 Batch   32/53   train_loss = 4.628
Epoch   4 Batch   33/53   train_loss = 4.709
Epoch   4 Batch   34/53   train_loss = 4.722
Epoch   4 Batch   35/53   train_loss = 4.825
Epoch   4 Batch   36/53   train_loss = 4.563
Epoch   4 Batch   37/53   train_loss = 4.841
Epoch   4 Batch   38/53   train_loss = 4.822
Epoch   4 Batch   39/53   train_loss = 4.692
Epoch   4 Batch   40/53   train_loss = 4.552
Epoch   4 Batch   41/53   train_loss = 5.094
Epoch   4 Batch   42/53   train_loss = 4.568
Epoch   4 Batch   43/53   train_loss = 5.034
Epoch   4 Batch   44/53   train_loss = 4.586
Epoch   4 Batch   45/53   train_loss = 4.673
Epoch   4 Batch   46/53   train_loss = 4.905
Epoch   4 Batch   47/53   train_loss = 5.006
Epoch   4 Batch   48/53   train_loss = 4.500
Epoch   4 Batch   49/53   train_loss = 4.799
Epoch   4 Batch   50/53   train_loss = 4.747
Epoch   4 Batch   51/53   train_loss = 4.753
Epoch   4 Batch   52/53   train_loss = 4.576
Epoch   5 Batch    0/53   train_loss = 2.752
Epoch   5 Batch    1/53   train_loss = 4.627
Epoch   5 Batch    2/53   train_loss = 4.473
Epoch   5 Batch    3/53   train_loss = 4.457
Epoch   5 Batch    4/53   train_loss = 4.329
Epoch   5 Batch    5/53   train_loss = 4.387
Epoch   5 Batch    6/53   train_loss = 4.026
Epoch   5 Batch    7/53   train_loss = 4.496
Epoch   5 Batch    8/53   train_loss = 4.276
Epoch   5 Batch    9/53   train_loss = 4.243
Epoch   5 Batch   10/53   train_loss = 4.226
Epoch   5 Batch   11/53   train_loss = 4.610
Epoch   5 Batch   12/53   train_loss = 4.020
Epoch   5 Batch   13/53   train_loss = 4.456
Epoch   5 Batch   14/53   train_loss = 4.305
Epoch   5 Batch   15/53   train_loss = 4.281
Epoch   5 Batch   16/53   train_loss = 4.215
Epoch   5 Batch   17/53   train_loss = 4.538
Epoch   5 Batch   18/53   train_loss = 4.118
Epoch   5 Batch   19/53   train_loss = 4.578
Epoch   5 Batch   20/53   train_loss = 4.057
Epoch   5 Batch   21/53   train_loss = 4.279
Epoch   5 Batch   22/53   train_loss = 4.355
Epoch   5 Batch   23/53   train_loss = 4.609
Epoch   5 Batch   24/53   train_loss = 4.064
Epoch   5 Batch   25/53   train_loss = 4.332
Epoch   5 Batch   26/53   train_loss = 4.214
Epoch   5 Batch   27/53   train_loss = 4.321
Epoch   5 Batch   28/53   train_loss = 4.210
Epoch   5 Batch   29/53   train_loss = 4.482
Epoch   5 Batch   30/53   train_loss = 4.063
Epoch   5 Batch   31/53   train_loss = 4.633
Epoch   5 Batch   32/53   train_loss = 4.253
Epoch   5 Batch   33/53   train_loss = 4.310
Epoch   5 Batch   34/53   train_loss = 4.370
Epoch   5 Batch   35/53   train_loss = 4.396
Epoch   5 Batch   36/53   train_loss = 4.136
Epoch   5 Batch   37/53   train_loss = 4.507
Epoch   5 Batch   38/53   train_loss = 4.501
Epoch   5 Batch   39/53   train_loss = 4.346
Epoch   5 Batch   40/53   train_loss = 4.140
Epoch   5 Batch   41/53   train_loss = 4.754
Epoch   5 Batch   42/53   train_loss = 4.176
Epoch   5 Batch   43/53   train_loss = 4.738
Epoch   5 Batch   44/53   train_loss = 4.220
Epoch   5 Batch   45/53   train_loss = 4.267
Epoch   5 Batch   46/53   train_loss = 4.535
Epoch   5 Batch   47/53   train_loss = 4.657
Epoch   5 Batch   48/53   train_loss = 4.126
Epoch   5 Batch   49/53   train_loss = 4.434
Epoch   5 Batch   50/53   train_loss = 4.345
Epoch   5 Batch   51/53   train_loss = 4.395
Epoch   5 Batch   52/53   train_loss = 4.229
Epoch   6 Batch    0/53   train_loss = 2.105
Epoch   6 Batch    1/53   train_loss = 4.259
Epoch   6 Batch    2/53   train_loss = 4.117
Epoch   6 Batch    3/53   train_loss = 4.046
Epoch   6 Batch    4/53   train_loss = 3.951
Epoch   6 Batch    5/53   train_loss = 3.970
Epoch   6 Batch    6/53   train_loss = 3.652
Epoch   6 Batch    7/53   train_loss = 4.064
Epoch   6 Batch    8/53   train_loss = 3.836
Epoch   6 Batch    9/53   train_loss = 3.819
Epoch   6 Batch   10/53   train_loss = 3.762
Epoch   6 Batch   11/53   train_loss = 4.192
Epoch   6 Batch   12/53   train_loss = 3.597
Epoch   6 Batch   13/53   train_loss = 4.075
Epoch   6 Batch   14/53   train_loss = 3.885
Epoch   6 Batch   15/53   train_loss = 3.928
Epoch   6 Batch   16/53   train_loss = 3.832
Epoch   6 Batch   17/53   train_loss = 4.227
Epoch   6 Batch   18/53   train_loss = 3.734
Epoch   6 Batch   19/53   train_loss = 4.246
Epoch   6 Batch   20/53   train_loss = 3.628
Epoch   6 Batch   21/53   train_loss = 3.894
Epoch   6 Batch   22/53   train_loss = 3.999
Epoch   6 Batch   23/53   train_loss = 4.304
Epoch   6 Batch   24/53   train_loss = 3.692
Epoch   6 Batch   25/53   train_loss = 3.943
Epoch   6 Batch   26/53   train_loss = 3.829
Epoch   6 Batch   27/53   train_loss = 3.992
Epoch   6 Batch   28/53   train_loss = 3.829
Epoch   6 Batch   29/53   train_loss = 4.166
Epoch   6 Batch   30/53   train_loss = 3.665
Epoch   6 Batch   31/53   train_loss = 4.337
Epoch   6 Batch   32/53   train_loss = 3.941
Epoch   6 Batch   33/53   train_loss = 3.989
Epoch   6 Batch   34/53   train_loss = 4.079
Epoch   6 Batch   35/53   train_loss = 4.019
Epoch   6 Batch   36/53   train_loss = 3.811
Epoch   6 Batch   37/53   train_loss = 4.219
Epoch   6 Batch   38/53   train_loss = 4.181
Epoch   6 Batch   39/53   train_loss = 4.033
Epoch   6 Batch   40/53   train_loss = 3.773
Epoch   6 Batch   41/53   train_loss = 4.492
Epoch   6 Batch   42/53   train_loss = 3.816
Epoch   6 Batch   43/53   train_loss = 4.473
Epoch   6 Batch   44/53   train_loss = 3.890
Epoch   6 Batch   45/53   train_loss = 3.918
Epoch   6 Batch   46/53   train_loss = 4.215
Epoch   6 Batch   47/53   train_loss = 4.382
Epoch   6 Batch   48/53   train_loss = 3.775
Epoch   6 Batch   49/53   train_loss = 4.115
Epoch   6 Batch   50/53   train_loss = 3.978
Epoch   6 Batch   51/53   train_loss = 4.043
Epoch   6 Batch   52/53   train_loss = 3.837
Epoch   7 Batch    0/53   train_loss = 1.272
Epoch   7 Batch    1/53   train_loss = 3.953
Epoch   7 Batch    2/53   train_loss = 3.785
Epoch   7 Batch    3/53   train_loss = 3.724
Epoch   7 Batch    4/53   train_loss = 3.641
Epoch   7 Batch    5/53   train_loss = 3.674
Epoch   7 Batch    6/53   train_loss = 3.324
Epoch   7 Batch    7/53   train_loss = 3.761
Epoch   7 Batch    8/53   train_loss = 3.495
Epoch   7 Batch    9/53   train_loss = 3.463
Epoch   7 Batch   10/53   train_loss = 3.390
Epoch   7 Batch   11/53   train_loss = 3.881
Epoch   7 Batch   12/53   train_loss = 3.218
Epoch   7 Batch   13/53   train_loss = 3.801
Epoch   7 Batch   14/53   train_loss = 3.485
Epoch   7 Batch   15/53   train_loss = 3.582
Epoch   7 Batch   16/53   train_loss = 3.487
Epoch   7 Batch   17/53   train_loss = 3.922
Epoch   7 Batch   18/53   train_loss = 3.362
Epoch   7 Batch   19/53   train_loss = 3.965
Epoch   7 Batch   20/53   train_loss = 3.245
Epoch   7 Batch   21/53   train_loss = 3.536
Epoch   7 Batch   22/53   train_loss = 3.678
Epoch   7 Batch   23/53   train_loss = 3.983
Epoch   7 Batch   24/53   train_loss = 3.348
Epoch   7 Batch   25/53   train_loss = 3.620
Epoch   7 Batch   26/53   train_loss = 3.565
Epoch   7 Batch   27/53   train_loss = 3.684
Epoch   7 Batch   28/53   train_loss = 3.500
Epoch   7 Batch   29/53   train_loss = 3.937
Epoch   7 Batch   30/53   train_loss = 3.315
Epoch   7 Batch   31/53   train_loss = 4.060
Epoch   7 Batch   32/53   train_loss = 3.616
Epoch   7 Batch   33/53   train_loss = 3.688
Epoch   7 Batch   34/53   train_loss = 3.799
Epoch   7 Batch   35/53   train_loss = 3.739
Epoch   7 Batch   36/53   train_loss = 3.453
Epoch   7 Batch   37/53   train_loss = 4.021
Epoch   7 Batch   38/53   train_loss = 3.883
Epoch   7 Batch   39/53   train_loss = 3.763
Epoch   7 Batch   40/53   train_loss = 3.430
Epoch   7 Batch   41/53   train_loss = 4.255
Epoch   7 Batch   42/53   train_loss = 3.502
Epoch   7 Batch   43/53   train_loss = 4.241
Epoch   7 Batch   44/53   train_loss = 3.628
Epoch   7 Batch   45/53   train_loss = 3.646
Epoch   7 Batch   46/53   train_loss = 3.929
Epoch   7 Batch   47/53   train_loss = 4.143
Epoch   7 Batch   48/53   train_loss = 3.485
Epoch   7 Batch   49/53   train_loss = 3.897
Epoch   7 Batch   50/53   train_loss = 3.654
Epoch   7 Batch   51/53   train_loss = 3.750
Epoch   7 Batch   52/53   train_loss = 3.546
Epoch   8 Batch    0/53   train_loss = 0.883
Epoch   8 Batch    1/53   train_loss = 3.710
Epoch   8 Batch    2/53   train_loss = 3.448
Epoch   8 Batch    3/53   train_loss = 3.374
Epoch   8 Batch    4/53   train_loss = 3.247
Epoch   8 Batch    5/53   train_loss = 3.311
Epoch   8 Batch    6/53   train_loss = 2.936
Epoch   8 Batch    7/53   train_loss = 3.406
Epoch   8 Batch    8/53   train_loss = 3.126
Epoch   8 Batch    9/53   train_loss = 3.123
Epoch   8 Batch   10/53   train_loss = 3.033
Epoch   8 Batch   11/53   train_loss = 3.546
Epoch   8 Batch   12/53   train_loss = 2.866
Epoch   8 Batch   13/53   train_loss = 3.478
Epoch   8 Batch   14/53   train_loss = 3.091
Epoch   8 Batch   15/53   train_loss = 3.237
Epoch   8 Batch   16/53   train_loss = 3.152
Epoch   8 Batch   17/53   train_loss = 3.639
Epoch   8 Batch   18/53   train_loss = 3.014
Epoch   8 Batch   19/53   train_loss = 3.667
Epoch   8 Batch   20/53   train_loss = 2.946
Epoch   8 Batch   21/53   train_loss = 3.215
Epoch   8 Batch   22/53   train_loss = 3.364
Epoch   8 Batch   23/53   train_loss = 3.745
Epoch   8 Batch   24/53   train_loss = 3.029
Epoch   8 Batch   25/53   train_loss = 3.305
Epoch   8 Batch   26/53   train_loss = 3.217
Epoch   8 Batch   27/53   train_loss = 3.395
Epoch   8 Batch   28/53   train_loss = 3.168
Epoch   8 Batch   29/53   train_loss = 3.665
Epoch   8 Batch   30/53   train_loss = 2.978
Epoch   8 Batch   31/53   train_loss = 3.816
Epoch   8 Batch   32/53   train_loss = 3.341
Epoch   8 Batch   33/53   train_loss = 3.408
Epoch   8 Batch   34/53   train_loss = 3.535
Epoch   8 Batch   35/53   train_loss = 3.425
Epoch   8 Batch   36/53   train_loss = 3.086
Epoch   8 Batch   37/53   train_loss = 3.765
Epoch   8 Batch   38/53   train_loss = 3.605
Epoch   8 Batch   39/53   train_loss = 3.492
Epoch   8 Batch   40/53   train_loss = 3.097
Epoch   8 Batch   41/53   train_loss = 3.984
Epoch   8 Batch   42/53   train_loss = 3.195
Epoch   8 Batch   43/53   train_loss = 3.975
Epoch   8 Batch   44/53   train_loss = 3.328
Epoch   8 Batch   45/53   train_loss = 3.334
Epoch   8 Batch   46/53   train_loss = 3.625
Epoch   8 Batch   47/53   train_loss = 3.939
Epoch   8 Batch   48/53   train_loss = 3.163
Epoch   8 Batch   49/53   train_loss = 3.621
Epoch   8 Batch   50/53   train_loss = 3.351
Epoch   8 Batch   51/53   train_loss = 3.453
Epoch   8 Batch   52/53   train_loss = 3.265
Epoch   9 Batch    0/53   train_loss = 0.559
Epoch   9 Batch    1/53   train_loss = 3.473
Epoch   9 Batch    2/53   train_loss = 3.191
Epoch   9 Batch    3/53   train_loss = 3.024
Epoch   9 Batch    4/53   train_loss = 2.900
Epoch   9 Batch    5/53   train_loss = 2.961
Epoch   9 Batch    6/53   train_loss = 2.635
Epoch   9 Batch    7/53   train_loss = 3.061
Epoch   9 Batch    8/53   train_loss = 2.765
Epoch   9 Batch    9/53   train_loss = 2.805
Epoch   9 Batch   10/53   train_loss = 2.703
Epoch   9 Batch   11/53   train_loss = 3.245
Epoch   9 Batch   12/53   train_loss = 2.551
Epoch   9 Batch   13/53   train_loss = 3.170
Epoch   9 Batch   14/53   train_loss = 2.736
Epoch   9 Batch   15/53   train_loss = 2.892
Epoch   9 Batch   16/53   train_loss = 2.826
Epoch   9 Batch   17/53   train_loss = 3.310
Epoch   9 Batch   18/53   train_loss = 2.689
Epoch   9 Batch   19/53   train_loss = 3.373
Epoch   9 Batch   20/53   train_loss = 2.596
Epoch   9 Batch   21/53   train_loss = 2.918
Epoch   9 Batch   22/53   train_loss = 3.037
Epoch   9 Batch   23/53   train_loss = 3.431
Epoch   9 Batch   24/53   train_loss = 2.717
Epoch   9 Batch   25/53   train_loss = 2.997
Epoch   9 Batch   26/53   train_loss = 2.903
Epoch   9 Batch   27/53   train_loss = 3.140
Epoch   9 Batch   28/53   train_loss = 2.862
Epoch   9 Batch   29/53   train_loss = 3.415
Epoch   9 Batch   30/53   train_loss = 2.640
Epoch   9 Batch   31/53   train_loss = 3.557
Epoch   9 Batch   32/53   train_loss = 3.070
Epoch   9 Batch   33/53   train_loss = 3.175
Epoch   9 Batch   34/53   train_loss = 3.269
Epoch   9 Batch   35/53   train_loss = 3.165
Epoch   9 Batch   36/53   train_loss = 2.787
Epoch   9 Batch   37/53   train_loss = 3.530
Epoch   9 Batch   38/53   train_loss = 3.357
Epoch   9 Batch   39/53   train_loss = 3.226
Epoch   9 Batch   40/53   train_loss = 2.791
Epoch   9 Batch   41/53   train_loss = 3.721
Epoch   9 Batch   42/53   train_loss = 2.880
Epoch   9 Batch   43/53   train_loss = 3.750
Epoch   9 Batch   44/53   train_loss = 3.076
Epoch   9 Batch   45/53   train_loss = 3.058
Epoch   9 Batch   46/53   train_loss = 3.354
Epoch   9 Batch   47/53   train_loss = 3.755
Epoch   9 Batch   48/53   train_loss = 2.919
Epoch   9 Batch   49/53   train_loss = 3.378
Epoch   9 Batch   50/53   train_loss = 3.155
Epoch   9 Batch   51/53   train_loss = 3.206
Epoch   9 Batch   52/53   train_loss = 3.047
Epoch  10 Batch    0/53   train_loss = 0.391
Epoch  10 Batch    1/53   train_loss = 3.210
Epoch  10 Batch    2/53   train_loss = 2.901
Epoch  10 Batch    3/53   train_loss = 2.782
Epoch  10 Batch    4/53   train_loss = 2.608
Epoch  10 Batch    5/53   train_loss = 2.703
Epoch  10 Batch    6/53   train_loss = 2.347
Epoch  10 Batch    7/53   train_loss = 2.763
Epoch  10 Batch    8/53   train_loss = 2.436
Epoch  10 Batch    9/53   train_loss = 2.520
Epoch  10 Batch   10/53   train_loss = 2.423
Epoch  10 Batch   11/53   train_loss = 2.950
Epoch  10 Batch   12/53   train_loss = 2.233
Epoch  10 Batch   13/53   train_loss = 2.902
Epoch  10 Batch   14/53   train_loss = 2.414
Epoch  10 Batch   15/53   train_loss = 2.621
Epoch  10 Batch   16/53   train_loss = 2.543
Epoch  10 Batch   17/53   train_loss = 3.022
Epoch  10 Batch   18/53   train_loss = 2.377
Epoch  10 Batch   19/53   train_loss = 3.104
Epoch  10 Batch   20/53   train_loss = 2.317
Epoch  10 Batch   21/53   train_loss = 2.647
Epoch  10 Batch   22/53   train_loss = 2.752
Epoch  10 Batch   23/53   train_loss = 3.201
Epoch  10 Batch   24/53   train_loss = 2.410
Epoch  10 Batch   25/53   train_loss = 2.737
Epoch  10 Batch   26/53   train_loss = 2.618
Epoch  10 Batch   27/53   train_loss = 2.899
Epoch  10 Batch   28/53   train_loss = 2.578
Epoch  10 Batch   29/53   train_loss = 3.217
Epoch  10 Batch   30/53   train_loss = 2.337
Epoch  10 Batch   31/53   train_loss = 3.275
Epoch  10 Batch   32/53   train_loss = 2.813
Epoch  10 Batch   33/53   train_loss = 2.907
Epoch  10 Batch   34/53   train_loss = 3.012
Epoch  10 Batch   35/53   train_loss = 2.901
Epoch  10 Batch   36/53   train_loss = 2.497
Epoch  10 Batch   37/53   train_loss = 3.335
Epoch  10 Batch   38/53   train_loss = 3.124
Epoch  10 Batch   39/53   train_loss = 2.990
Epoch  10 Batch   40/53   train_loss = 2.523
Epoch  10 Batch   41/53   train_loss = 3.532
Epoch  10 Batch   42/53   train_loss = 2.611
Epoch  10 Batch   43/53   train_loss = 3.524
Epoch  10 Batch   44/53   train_loss = 2.816
Epoch  10 Batch   45/53   train_loss = 2.809
Epoch  10 Batch   46/53   train_loss = 3.048
Epoch  10 Batch   47/53   train_loss = 3.541
Epoch  10 Batch   48/53   train_loss = 2.689
Epoch  10 Batch   49/53   train_loss = 3.170
Epoch  10 Batch   50/53   train_loss = 2.845
Epoch  10 Batch   51/53   train_loss = 2.978
Epoch  10 Batch   52/53   train_loss = 2.781
Epoch  11 Batch    0/53   train_loss = 0.256
Epoch  11 Batch    1/53   train_loss = 3.058
Epoch  11 Batch    2/53   train_loss = 2.606
Epoch  11 Batch    3/53   train_loss = 2.588
Epoch  11 Batch    4/53   train_loss = 2.407
Epoch  11 Batch    5/53   train_loss = 2.462
Epoch  11 Batch    6/53   train_loss = 2.142
Epoch  11 Batch    7/53   train_loss = 2.511
Epoch  11 Batch    8/53   train_loss = 2.190
Epoch  11 Batch    9/53   train_loss = 2.286
Epoch  11 Batch   10/53   train_loss = 2.150
Epoch  11 Batch   11/53   train_loss = 2.709
Epoch  11 Batch   12/53   train_loss = 1.995
Epoch  11 Batch   13/53   train_loss = 2.640
Epoch  11 Batch   14/53   train_loss = 2.162
Epoch  11 Batch   15/53   train_loss = 2.340
Epoch  11 Batch   16/53   train_loss = 2.273
Epoch  11 Batch   17/53   train_loss = 2.792
Epoch  11 Batch   18/53   train_loss = 2.076
Epoch  11 Batch   19/53   train_loss = 2.854
Epoch  11 Batch   20/53   train_loss = 2.048
Epoch  11 Batch   21/53   train_loss = 2.401
Epoch  11 Batch   22/53   train_loss = 2.459
Epoch  11 Batch   23/53   train_loss = 2.898
Epoch  11 Batch   24/53   train_loss = 2.152
Epoch  11 Batch   25/53   train_loss = 2.501
Epoch  11 Batch   26/53   train_loss = 2.385
Epoch  11 Batch   27/53   train_loss = 2.646
Epoch  11 Batch   28/53   train_loss = 2.298
Epoch  11 Batch   29/53   train_loss = 2.982
Epoch  11 Batch   30/53   train_loss = 2.103
Epoch  11 Batch   31/53   train_loss = 3.004
Epoch  11 Batch   32/53   train_loss = 2.606
Epoch  11 Batch   33/53   train_loss = 2.625
Epoch  11 Batch   34/53   train_loss = 2.792
Epoch  11 Batch   35/53   train_loss = 2.646
Epoch  11 Batch   36/53   train_loss = 2.235
Epoch  11 Batch   37/53   train_loss = 3.121
Epoch  11 Batch   38/53   train_loss = 2.858
Epoch  11 Batch   39/53   train_loss = 2.760
Epoch  11 Batch   40/53   train_loss = 2.259
Epoch  11 Batch   41/53   train_loss = 3.342
Epoch  11 Batch   42/53   train_loss = 2.406
Epoch  11 Batch   43/53   train_loss = 3.341
Epoch  11 Batch   44/53   train_loss = 2.605
Epoch  11 Batch   45/53   train_loss = 2.595
Epoch  11 Batch   46/53   train_loss = 2.812
Epoch  11 Batch   47/53   train_loss = 3.331
Epoch  11 Batch   48/53   train_loss = 2.397
Epoch  11 Batch   49/53   train_loss = 2.956
Epoch  11 Batch   50/53   train_loss = 2.612
Epoch  11 Batch   51/53   train_loss = 2.706
Epoch  11 Batch   52/53   train_loss = 2.564
Epoch  12 Batch    0/53   train_loss = 0.154
Epoch  12 Batch    1/53   train_loss = 2.835
Epoch  12 Batch    2/53   train_loss = 2.407
Epoch  12 Batch    3/53   train_loss = 2.300
Epoch  12 Batch    4/53   train_loss = 2.127
Epoch  12 Batch    5/53   train_loss = 2.225
Epoch  12 Batch    6/53   train_loss = 1.893
Epoch  12 Batch    7/53   train_loss = 2.247
Epoch  12 Batch    8/53   train_loss = 1.918
Epoch  12 Batch    9/53   train_loss = 2.076
Epoch  12 Batch   10/53   train_loss = 1.938
Epoch  12 Batch   11/53   train_loss = 2.451
Epoch  12 Batch   12/53   train_loss = 1.765
Epoch  12 Batch   13/53   train_loss = 2.421
Epoch  12 Batch   14/53   train_loss = 1.901
Epoch  12 Batch   15/53   train_loss = 2.120
Epoch  12 Batch   16/53   train_loss = 2.037
Epoch  12 Batch   17/53   train_loss = 2.526
Epoch  12 Batch   18/53   train_loss = 1.857
Epoch  12 Batch   19/53   train_loss = 2.602
Epoch  12 Batch   20/53   train_loss = 1.838
Epoch  12 Batch   21/53   train_loss = 2.165
Epoch  12 Batch   22/53   train_loss = 2.237
Epoch  12 Batch   23/53   train_loss = 2.659
Epoch  12 Batch   24/53   train_loss = 1.951
Epoch  12 Batch   25/53   train_loss = 2.276
Epoch  12 Batch   26/53   train_loss = 2.183
Epoch  12 Batch   27/53   train_loss = 2.422
Epoch  12 Batch   28/53   train_loss = 2.076
Epoch  12 Batch   29/53   train_loss = 2.775
Epoch  12 Batch   30/53   train_loss = 1.870
Epoch  12 Batch   31/53   train_loss = 2.758
Epoch  12 Batch   32/53   train_loss = 2.388
Epoch  12 Batch   33/53   train_loss = 2.419
Epoch  12 Batch   34/53   train_loss = 2.601
Epoch  12 Batch   35/53   train_loss = 2.415
Epoch  12 Batch   36/53   train_loss = 2.030
Epoch  12 Batch   37/53   train_loss = 2.960
Epoch  12 Batch   38/53   train_loss = 2.647
Epoch  12 Batch   39/53   train_loss = 2.541
Epoch  12 Batch   40/53   train_loss = 2.025
Epoch  12 Batch   41/53   train_loss = 3.078
Epoch  12 Batch   42/53   train_loss = 2.158
Epoch  12 Batch   43/53   train_loss = 3.120
Epoch  12 Batch   44/53   train_loss = 2.363
Epoch  12 Batch   45/53   train_loss = 2.338
Epoch  12 Batch   46/53   train_loss = 2.579
Epoch  12 Batch   47/53   train_loss = 3.126
Epoch  12 Batch   48/53   train_loss = 2.192
Epoch  12 Batch   49/53   train_loss = 2.726
Epoch  12 Batch   50/53   train_loss = 2.376
Epoch  12 Batch   51/53   train_loss = 2.492
Epoch  12 Batch   52/53   train_loss = 2.340
Epoch  13 Batch    0/53   train_loss = 0.121
Epoch  13 Batch    1/53   train_loss = 2.519
Epoch  13 Batch    2/53   train_loss = 2.156
Epoch  13 Batch    3/53   train_loss = 2.014
Epoch  13 Batch    4/53   train_loss = 1.893
Epoch  13 Batch    5/53   train_loss = 1.979
Epoch  13 Batch    6/53   train_loss = 1.676
Epoch  13 Batch    7/53   train_loss = 2.002
Epoch  13 Batch    8/53   train_loss = 1.711
Epoch  13 Batch    9/53   train_loss = 1.832
Epoch  13 Batch   10/53   train_loss = 1.718
Epoch  13 Batch   11/53   train_loss = 2.254
Epoch  13 Batch   12/53   train_loss = 1.543
Epoch  13 Batch   13/53   train_loss = 2.194
Epoch  13 Batch   14/53   train_loss = 1.679
Epoch  13 Batch   15/53   train_loss = 1.936
Epoch  13 Batch   16/53   train_loss = 1.839
Epoch  13 Batch   17/53   train_loss = 2.327
Epoch  13 Batch   18/53   train_loss = 1.628
Epoch  13 Batch   19/53   train_loss = 2.403
Epoch  13 Batch   20/53   train_loss = 1.640
Epoch  13 Batch   21/53   train_loss = 1.941
Epoch  13 Batch   22/53   train_loss = 2.040
Epoch  13 Batch   23/53   train_loss = 2.407
Epoch  13 Batch   24/53   train_loss = 1.726
Epoch  13 Batch   25/53   train_loss = 2.085
Epoch  13 Batch   26/53   train_loss = 1.923
Epoch  13 Batch   27/53   train_loss = 2.254
Epoch  13 Batch   28/53   train_loss = 1.892
Epoch  13 Batch   29/53   train_loss = 2.584
Epoch  13 Batch   30/53   train_loss = 1.675
Epoch  13 Batch   31/53   train_loss = 2.547
Epoch  13 Batch   32/53   train_loss = 2.186
Epoch  13 Batch   33/53   train_loss = 2.208
Epoch  13 Batch   34/53   train_loss = 2.387
Epoch  13 Batch   35/53   train_loss = 2.221
Epoch  13 Batch   36/53   train_loss = 1.827
Epoch  13 Batch   37/53   train_loss = 2.720
Epoch  13 Batch   38/53   train_loss = 2.436
Epoch  13 Batch   39/53   train_loss = 2.281
Epoch  13 Batch   40/53   train_loss = 1.821
Epoch  13 Batch   41/53   train_loss = 2.830
Epoch  13 Batch   42/53   train_loss = 1.951
Epoch  13 Batch   43/53   train_loss = 2.876
Epoch  13 Batch   44/53   train_loss = 2.164
Epoch  13 Batch   45/53   train_loss = 2.143
Epoch  13 Batch   46/53   train_loss = 2.339
Epoch  13 Batch   47/53   train_loss = 2.889
Epoch  13 Batch   48/53   train_loss = 2.000
Epoch  13 Batch   49/53   train_loss = 2.507
Epoch  13 Batch   50/53   train_loss = 2.142
Epoch  13 Batch   51/53   train_loss = 2.236
Epoch  13 Batch   52/53   train_loss = 2.118
Epoch  14 Batch    0/53   train_loss = 0.098
Epoch  14 Batch    1/53   train_loss = 2.325
Epoch  14 Batch    2/53   train_loss = 1.914
Epoch  14 Batch    3/53   train_loss = 1.819
Epoch  14 Batch    4/53   train_loss = 1.700
Epoch  14 Batch    5/53   train_loss = 1.762
Epoch  14 Batch    6/53   train_loss = 1.485
Epoch  14 Batch    7/53   train_loss = 1.818
Epoch  14 Batch    8/53   train_loss = 1.502
Epoch  14 Batch    9/53   train_loss = 1.625
Epoch  14 Batch   10/53   train_loss = 1.524
Epoch  14 Batch   11/53   train_loss = 1.998
Epoch  14 Batch   12/53   train_loss = 1.390
Epoch  14 Batch   13/53   train_loss = 1.985
Epoch  14 Batch   14/53   train_loss = 1.469
Epoch  14 Batch   15/53   train_loss = 1.721
Epoch  14 Batch   16/53   train_loss = 1.648
Epoch  14 Batch   17/53   train_loss = 2.083
Epoch  14 Batch   18/53   train_loss = 1.435
Epoch  14 Batch   19/53   train_loss = 2.176
Epoch  14 Batch   20/53   train_loss = 1.466
Epoch  14 Batch   21/53   train_loss = 1.738
Epoch  14 Batch   22/53   train_loss = 1.791
Epoch  14 Batch   23/53   train_loss = 2.184
Epoch  14 Batch   24/53   train_loss = 1.547
Epoch  14 Batch   25/53   train_loss = 1.915
Epoch  14 Batch   26/53   train_loss = 1.716
Epoch  14 Batch   27/53   train_loss = 2.036
Epoch  14 Batch   28/53   train_loss = 1.683
Epoch  14 Batch   29/53   train_loss = 2.391
Epoch  14 Batch   30/53   train_loss = 1.483
Epoch  14 Batch   31/53   train_loss = 2.297
Epoch  14 Batch   32/53   train_loss = 2.004
Epoch  14 Batch   33/53   train_loss = 1.993
Epoch  14 Batch   34/53   train_loss = 2.225
Epoch  14 Batch   35/53   train_loss = 2.028
Epoch  14 Batch   36/53   train_loss = 1.650
Epoch  14 Batch   37/53   train_loss = 2.569
Epoch  14 Batch   38/53   train_loss = 2.249
Epoch  14 Batch   39/53   train_loss = 2.079
Epoch  14 Batch   40/53   train_loss = 1.652
Epoch  14 Batch   41/53   train_loss = 2.616
Epoch  14 Batch   42/53   train_loss = 1.812
Epoch  14 Batch   43/53   train_loss = 2.646
Epoch  14 Batch   44/53   train_loss = 2.002
Epoch  14 Batch   45/53   train_loss = 1.963
Epoch  14 Batch   46/53   train_loss = 2.101
Epoch  14 Batch   47/53   train_loss = 2.682
Epoch  14 Batch   48/53   train_loss = 1.790
Epoch  14 Batch   49/53   train_loss = 2.300
Epoch  14 Batch   50/53   train_loss = 1.971
Epoch  14 Batch   51/53   train_loss = 1.986
Epoch  14 Batch   52/53   train_loss = 1.913
Epoch  15 Batch    0/53   train_loss = 0.079
Epoch  15 Batch    1/53   train_loss = 2.074
Epoch  15 Batch    2/53   train_loss = 1.703
Epoch  15 Batch    3/53   train_loss = 1.610
Epoch  15 Batch    4/53   train_loss = 1.497
Epoch  15 Batch    5/53   train_loss = 1.598
Epoch  15 Batch    6/53   train_loss = 1.320
Epoch  15 Batch    7/53   train_loss = 1.603
Epoch  15 Batch    8/53   train_loss = 1.308
Epoch  15 Batch    9/53   train_loss = 1.447
Epoch  15 Batch   10/53   train_loss = 1.327
Epoch  15 Batch   11/53   train_loss = 1.821
Epoch  15 Batch   12/53   train_loss = 1.201
Epoch  15 Batch   13/53   train_loss = 1.777
Epoch  15 Batch   14/53   train_loss = 1.291
Epoch  15 Batch   15/53   train_loss = 1.538
Epoch  15 Batch   16/53   train_loss = 1.467
Epoch  15 Batch   17/53   train_loss = 1.894
Epoch  15 Batch   18/53   train_loss = 1.261
Epoch  15 Batch   19/53   train_loss = 1.984
Epoch  15 Batch   20/53   train_loss = 1.313
Epoch  15 Batch   21/53   train_loss = 1.536
Epoch  15 Batch   22/53   train_loss = 1.592
Epoch  15 Batch   23/53   train_loss = 1.986
Epoch  15 Batch   24/53   train_loss = 1.339
Epoch  15 Batch   25/53   train_loss = 1.706
Epoch  15 Batch   26/53   train_loss = 1.513
Epoch  15 Batch   27/53   train_loss = 1.840
Epoch  15 Batch   28/53   train_loss = 1.517
Epoch  15 Batch   29/53   train_loss = 2.212
Epoch  15 Batch   30/53   train_loss = 1.300
Epoch  15 Batch   31/53   train_loss = 2.106
Epoch  15 Batch   32/53   train_loss = 1.804
Epoch  15 Batch   33/53   train_loss = 1.794
Epoch  15 Batch   34/53   train_loss = 2.020
Epoch  15 Batch   35/53   train_loss = 1.848
Epoch  15 Batch   36/53   train_loss = 1.497
Epoch  15 Batch   37/53   train_loss = 2.360
Epoch  15 Batch   38/53   train_loss = 2.046
Epoch  15 Batch   39/53   train_loss = 1.895
Epoch  15 Batch   40/53   train_loss = 1.438
Epoch  15 Batch   41/53   train_loss = 2.412
Epoch  15 Batch   42/53   train_loss = 1.643
Epoch  15 Batch   43/53   train_loss = 2.460
Epoch  15 Batch   44/53   train_loss = 1.835
Epoch  15 Batch   45/53   train_loss = 1.781
Epoch  15 Batch   46/53   train_loss = 1.922
Epoch  15 Batch   47/53   train_loss = 2.519
Epoch  15 Batch   48/53   train_loss = 1.667
Epoch  15 Batch   49/53   train_loss = 2.149
Epoch  15 Batch   50/53   train_loss = 1.792
Epoch  15 Batch   51/53   train_loss = 1.825
Epoch  15 Batch   52/53   train_loss = 1.805
Epoch  16 Batch    0/53   train_loss = 0.069
Epoch  16 Batch    1/53   train_loss = 1.872
Epoch  16 Batch    2/53   train_loss = 1.523
Epoch  16 Batch    3/53   train_loss = 1.434
Epoch  16 Batch    4/53   train_loss = 1.352
Epoch  16 Batch    5/53   train_loss = 1.413
Epoch  16 Batch    6/53   train_loss = 1.156
Epoch  16 Batch    7/53   train_loss = 1.466
Epoch  16 Batch    8/53   train_loss = 1.169
Epoch  16 Batch    9/53   train_loss = 1.275
Epoch  16 Batch   10/53   train_loss = 1.179
Epoch  16 Batch   11/53   train_loss = 1.644
Epoch  16 Batch   12/53   train_loss = 1.065
Epoch  16 Batch   13/53   train_loss = 1.622
Epoch  16 Batch   14/53   train_loss = 1.142
Epoch  16 Batch   15/53   train_loss = 1.396
Epoch  16 Batch   16/53   train_loss = 1.301
Epoch  16 Batch   17/53   train_loss = 1.740
Epoch  16 Batch   18/53   train_loss = 1.113
Epoch  16 Batch   19/53   train_loss = 1.822
Epoch  16 Batch   20/53   train_loss = 1.181
Epoch  16 Batch   21/53   train_loss = 1.391
Epoch  16 Batch   22/53   train_loss = 1.423
Epoch  16 Batch   23/53   train_loss = 1.803
Epoch  16 Batch   24/53   train_loss = 1.190
Epoch  16 Batch   25/53   train_loss = 1.558
Epoch  16 Batch   26/53   train_loss = 1.341
Epoch  16 Batch   27/53   train_loss = 1.669
Epoch  16 Batch   28/53   train_loss = 1.370
Epoch  16 Batch   29/53   train_loss = 2.056
Epoch  16 Batch   30/53   train_loss = 1.163
Epoch  16 Batch   31/53   train_loss = 1.917
Epoch  16 Batch   32/53   train_loss = 1.639
Epoch  16 Batch   33/53   train_loss = 1.626
Epoch  16 Batch   34/53   train_loss = 1.853
Epoch  16 Batch   35/53   train_loss = 1.667
Epoch  16 Batch   36/53   train_loss = 1.360
Epoch  16 Batch   37/53   train_loss = 2.180
Epoch  16 Batch   38/53   train_loss = 1.879
Epoch  16 Batch   39/53   train_loss = 1.744
Epoch  16 Batch   40/53   train_loss = 1.308
Epoch  16 Batch   41/53   train_loss = 2.278
Epoch  16 Batch   42/53   train_loss = 1.471
Epoch  16 Batch   43/53   train_loss = 2.265
Epoch  16 Batch   44/53   train_loss = 1.676
Epoch  16 Batch   45/53   train_loss = 1.619
Epoch  16 Batch   46/53   train_loss = 1.749
Epoch  16 Batch   47/53   train_loss = 2.325
Epoch  16 Batch   48/53   train_loss = 1.509
Epoch  16 Batch   49/53   train_loss = 1.959
Epoch  16 Batch   50/53   train_loss = 1.660
Epoch  16 Batch   51/53   train_loss = 1.640
Epoch  16 Batch   52/53   train_loss = 1.650
Epoch  17 Batch    0/53   train_loss = 0.060
Epoch  17 Batch    1/53   train_loss = 1.829
Epoch  17 Batch    2/53   train_loss = 1.384
Epoch  17 Batch    3/53   train_loss = 1.301
Epoch  17 Batch    4/53   train_loss = 1.280
Epoch  17 Batch    5/53   train_loss = 1.348
Epoch  17 Batch    6/53   train_loss = 1.071
Epoch  17 Batch    7/53   train_loss = 1.336
Epoch  17 Batch    8/53   train_loss = 1.074
Epoch  17 Batch    9/53   train_loss = 1.185
Epoch  17 Batch   10/53   train_loss = 1.074
Epoch  17 Batch   11/53   train_loss = 1.495
Epoch  17 Batch   12/53   train_loss = 0.961
Epoch  17 Batch   13/53   train_loss = 1.538
Epoch  17 Batch   14/53   train_loss = 1.077
Epoch  17 Batch   15/53   train_loss = 1.255
Epoch  17 Batch   16/53   train_loss = 1.200
Epoch  17 Batch   17/53   train_loss = 1.606
Epoch  17 Batch   18/53   train_loss = 1.006
Epoch  17 Batch   19/53   train_loss = 1.685
Epoch  17 Batch   20/53   train_loss = 1.056
Epoch  17 Batch   21/53   train_loss = 1.267
Epoch  17 Batch   22/53   train_loss = 1.301
Epoch  17 Batch   23/53   train_loss = 1.646
Epoch  17 Batch   24/53   train_loss = 1.050
Epoch  17 Batch   25/53   train_loss = 1.437
Epoch  17 Batch   26/53   train_loss = 1.220
Epoch  17 Batch   27/53   train_loss = 1.522
Epoch  17 Batch   28/53   train_loss = 1.231
Epoch  17 Batch   29/53   train_loss = 1.908
Epoch  17 Batch   30/53   train_loss = 1.031
Epoch  17 Batch   31/53   train_loss = 1.754
Epoch  17 Batch   32/53   train_loss = 1.482
Epoch  17 Batch   33/53   train_loss = 1.447
Epoch  17 Batch   34/53   train_loss = 1.719
Epoch  17 Batch   35/53   train_loss = 1.527
Epoch  17 Batch   36/53   train_loss = 1.214
Epoch  17 Batch   37/53   train_loss = 2.055
Epoch  17 Batch   38/53   train_loss = 1.722
Epoch  17 Batch   39/53   train_loss = 1.587
Epoch  17 Batch   40/53   train_loss = 1.193
Epoch  17 Batch   41/53   train_loss = 2.099
Epoch  17 Batch   42/53   train_loss = 1.399
Epoch  17 Batch   43/53   train_loss = 2.121
Epoch  17 Batch   44/53   train_loss = 1.552
Epoch  17 Batch   45/53   train_loss = 1.523
Epoch  17 Batch   46/53   train_loss = 1.592
Epoch  17 Batch   47/53   train_loss = 2.164
Epoch  17 Batch   48/53   train_loss = 1.379
Epoch  17 Batch   49/53   train_loss = 1.824
Epoch  17 Batch   50/53   train_loss = 1.530
Epoch  17 Batch   51/53   train_loss = 1.492
Epoch  17 Batch   52/53   train_loss = 1.471
Epoch  18 Batch    0/53   train_loss = 0.054
Epoch  18 Batch    1/53   train_loss = 1.686
Epoch  18 Batch    2/53   train_loss = 1.284
Epoch  18 Batch    3/53   train_loss = 1.132
Epoch  18 Batch    4/53   train_loss = 1.127
Epoch  18 Batch    5/53   train_loss = 1.204
Epoch  18 Batch    6/53   train_loss = 0.952
Epoch  18 Batch    7/53   train_loss = 1.200
Epoch  18 Batch    8/53   train_loss = 0.921
Epoch  18 Batch    9/53   train_loss = 1.045
Epoch  18 Batch   10/53   train_loss = 0.954
Epoch  18 Batch   11/53   train_loss = 1.392
Epoch  18 Batch   12/53   train_loss = 0.834
Epoch  18 Batch   13/53   train_loss = 1.353
Epoch  18 Batch   14/53   train_loss = 0.942
Epoch  18 Batch   15/53   train_loss = 1.172
Epoch  18 Batch   16/53   train_loss = 1.092
Epoch  18 Batch   17/53   train_loss = 1.437
Epoch  18 Batch   18/53   train_loss = 0.891
Epoch  18 Batch   19/53   train_loss = 1.594
Epoch  18 Batch   20/53   train_loss = 0.985
Epoch  18 Batch   21/53   train_loss = 1.130
Epoch  18 Batch   22/53   train_loss = 1.185
Epoch  18 Batch   23/53   train_loss = 1.516
Epoch  18 Batch   24/53   train_loss = 0.979
Epoch  18 Batch   25/53   train_loss = 1.310
Epoch  18 Batch   26/53   train_loss = 1.073
Epoch  18 Batch   27/53   train_loss = 1.419
Epoch  18 Batch   28/53   train_loss = 1.161
Epoch  18 Batch   29/53   train_loss = 1.776
Epoch  18 Batch   30/53   train_loss = 0.924
Epoch  18 Batch   31/53   train_loss = 1.619
Epoch  18 Batch   32/53   train_loss = 1.378
Epoch  18 Batch   33/53   train_loss = 1.328
Epoch  18 Batch   34/53   train_loss = 1.561
Epoch  18 Batch   35/53   train_loss = 1.384
Epoch  18 Batch   36/53   train_loss = 1.083
Epoch  18 Batch   37/53   train_loss = 1.918
Epoch  18 Batch   38/53   train_loss = 1.577
Epoch  18 Batch   39/53   train_loss = 1.450
Epoch  18 Batch   40/53   train_loss = 1.081
Epoch  18 Batch   41/53   train_loss = 1.951
Epoch  18 Batch   42/53   train_loss = 1.267
Epoch  18 Batch   43/53   train_loss = 1.964
Epoch  18 Batch   44/53   train_loss = 1.451
Epoch  18 Batch   45/53   train_loss = 1.382
Epoch  18 Batch   46/53   train_loss = 1.495
Epoch  18 Batch   47/53   train_loss = 2.097
Epoch  18 Batch   48/53   train_loss = 1.256
Epoch  18 Batch   49/53   train_loss = 1.684
Epoch  18 Batch   50/53   train_loss = 1.457
Epoch  18 Batch   51/53   train_loss = 1.429
Epoch  18 Batch   52/53   train_loss = 1.398
Epoch  19 Batch    0/53   train_loss = 0.045
Epoch  19 Batch    1/53   train_loss = 1.463
Epoch  19 Batch    2/53   train_loss = 1.165
Epoch  19 Batch    3/53   train_loss = 1.062
Epoch  19 Batch    4/53   train_loss = 0.985
Epoch  19 Batch    5/53   train_loss = 1.049
Epoch  19 Batch    6/53   train_loss = 0.830
Epoch  19 Batch    7/53   train_loss = 1.108
Epoch  19 Batch    8/53   train_loss = 0.826
Epoch  19 Batch    9/53   train_loss = 0.935
Epoch  19 Batch   10/53   train_loss = 0.838
Epoch  19 Batch   11/53   train_loss = 1.223
Epoch  19 Batch   12/53   train_loss = 0.734
Epoch  19 Batch   13/53   train_loss = 1.262
Epoch  19 Batch   14/53   train_loss = 0.845
Epoch  19 Batch   15/53   train_loss = 1.010
Epoch  19 Batch   16/53   train_loss = 0.972
Epoch  19 Batch   17/53   train_loss = 1.295
Epoch  19 Batch   18/53   train_loss = 0.805
Epoch  19 Batch   19/53   train_loss = 1.436
Epoch  19 Batch   20/53   train_loss = 0.878
Epoch  19 Batch   21/53   train_loss = 1.025
Epoch  19 Batch   22/53   train_loss = 1.065
Epoch  19 Batch   23/53   train_loss = 1.391
Epoch  19 Batch   24/53   train_loss = 0.850
Epoch  19 Batch   25/53   train_loss = 1.194
Epoch  19 Batch   26/53   train_loss = 0.988
Epoch  19 Batch   27/53   train_loss = 1.282
Epoch  19 Batch   28/53   train_loss = 1.031
Epoch  19 Batch   29/53   train_loss = 1.667
Epoch  19 Batch   30/53   train_loss = 0.829
Epoch  19 Batch   31/53   train_loss = 1.458
Epoch  19 Batch   32/53   train_loss = 1.258
Epoch  19 Batch   33/53   train_loss = 1.189
Epoch  19 Batch   34/53   train_loss = 1.433
Epoch  19 Batch   35/53   train_loss = 1.277
Epoch  19 Batch   36/53   train_loss = 1.005
Epoch  19 Batch   37/53   train_loss = 1.755
Epoch  19 Batch   38/53   train_loss = 1.411
Epoch  19 Batch   39/53   train_loss = 1.310
Epoch  19 Batch   40/53   train_loss = 0.981
Epoch  19 Batch   41/53   train_loss = 1.819
Epoch  19 Batch   42/53   train_loss = 1.153
Epoch  19 Batch   43/53   train_loss = 1.800
Epoch  19 Batch   44/53   train_loss = 1.328
Epoch  19 Batch   45/53   train_loss = 1.273
Epoch  19 Batch   46/53   train_loss = 1.318
Epoch  19 Batch   47/53   train_loss = 1.866
Epoch  19 Batch   48/53   train_loss = 1.169
Epoch  19 Batch   49/53   train_loss = 1.608
Epoch  19 Batch   50/53   train_loss = 1.329
Epoch  19 Batch   51/53   train_loss = 1.266
Epoch  19 Batch   52/53   train_loss = 1.279
Epoch  20 Batch    0/53   train_loss = 0.042
Epoch  20 Batch    1/53   train_loss = 1.418
Epoch  20 Batch    2/53   train_loss = 1.099
Epoch  20 Batch    3/53   train_loss = 0.907
Epoch  20 Batch    4/53   train_loss = 0.907
Epoch  20 Batch    5/53   train_loss = 1.004
Epoch  20 Batch    6/53   train_loss = 0.791
Epoch  20 Batch    7/53   train_loss = 0.971
Epoch  20 Batch    8/53   train_loss = 0.706
Epoch  20 Batch    9/53   train_loss = 0.844
Epoch  20 Batch   10/53   train_loss = 0.766
Epoch  20 Batch   11/53   train_loss = 1.099
Epoch  20 Batch   12/53   train_loss = 0.650
Epoch  20 Batch   13/53   train_loss = 1.113
Epoch  20 Batch   14/53   train_loss = 0.710
Epoch  20 Batch   15/53   train_loss = 0.921
Epoch  20 Batch   16/53   train_loss = 0.854
Epoch  20 Batch   17/53   train_loss = 1.201
Epoch  20 Batch   18/53   train_loss = 0.714
Epoch  20 Batch   19/53   train_loss = 1.294
Epoch  20 Batch   20/53   train_loss = 0.781
Epoch  20 Batch   21/53   train_loss = 0.920
Epoch  20 Batch   22/53   train_loss = 0.959
Epoch  20 Batch   23/53   train_loss = 1.258
Epoch  20 Batch   24/53   train_loss = 0.755
Epoch  20 Batch   25/53   train_loss = 1.090
Epoch  20 Batch   26/53   train_loss = 0.857
Epoch  20 Batch   27/53   train_loss = 1.164
Epoch  20 Batch   28/53   train_loss = 0.906
Epoch  20 Batch   29/53   train_loss = 1.522
Epoch  20 Batch   30/53   train_loss = 0.753
Epoch  20 Batch   31/53   train_loss = 1.341
Epoch  20 Batch   32/53   train_loss = 1.125
Epoch  20 Batch   33/53   train_loss = 1.079
Epoch  20 Batch   34/53   train_loss = 1.329
Epoch  20 Batch   35/53   train_loss = 1.155
Epoch  20 Batch   36/53   train_loss = 0.899
Epoch  20 Batch   37/53   train_loss = 1.585
Epoch  20 Batch   38/53   train_loss = 1.305
Epoch  20 Batch   39/53   train_loss = 1.181
Epoch  20 Batch   40/53   train_loss = 0.856
Epoch  20 Batch   41/53   train_loss = 1.636
Epoch  20 Batch   42/53   train_loss = 1.042
Epoch  20 Batch   43/53   train_loss = 1.653
Epoch  20 Batch   44/53   train_loss = 1.208
Epoch  20 Batch   45/53   train_loss = 1.146
Epoch  20 Batch   46/53   train_loss = 1.210
Epoch  20 Batch   47/53   train_loss = 1.738
Epoch  20 Batch   48/53   train_loss = 1.041
Epoch  20 Batch   49/53   train_loss = 1.445
Epoch  20 Batch   50/53   train_loss = 1.239
Epoch  20 Batch   51/53   train_loss = 1.212
Epoch  20 Batch   52/53   train_loss = 1.218
Epoch  21 Batch    0/53   train_loss = 0.034
Epoch  21 Batch    1/53   train_loss = 1.280
Epoch  21 Batch    2/53   train_loss = 0.955
Epoch  21 Batch    3/53   train_loss = 0.839
Epoch  21 Batch    4/53   train_loss = 0.885
Epoch  21 Batch    5/53   train_loss = 0.889
Epoch  21 Batch    6/53   train_loss = 0.671
Epoch  21 Batch    7/53   train_loss = 0.903
Epoch  21 Batch    8/53   train_loss = 0.704
Epoch  21 Batch    9/53   train_loss = 0.780
Epoch  21 Batch   10/53   train_loss = 0.672
Epoch  21 Batch   11/53   train_loss = 1.009
Epoch  21 Batch   12/53   train_loss = 0.588
Epoch  21 Batch   13/53   train_loss = 1.060
Epoch  21 Batch   14/53   train_loss = 0.647
Epoch  21 Batch   15/53   train_loss = 0.820
Epoch  21 Batch   16/53   train_loss = 0.784
Epoch  21 Batch   17/53   train_loss = 1.085
Epoch  21 Batch   18/53   train_loss = 0.639
Epoch  21 Batch   19/53   train_loss = 1.214
Epoch  21 Batch   20/53   train_loss = 0.703
Epoch  21 Batch   21/53   train_loss = 0.839
Epoch  21 Batch   22/53   train_loss = 0.850
Epoch  21 Batch   23/53   train_loss = 1.155
Epoch  21 Batch   24/53   train_loss = 0.684
Epoch  21 Batch   25/53   train_loss = 1.019
Epoch  21 Batch   26/53   train_loss = 0.784
Epoch  21 Batch   27/53   train_loss = 1.051
Epoch  21 Batch   28/53   train_loss = 0.832
Epoch  21 Batch   29/53   train_loss = 1.405
Epoch  21 Batch   30/53   train_loss = 0.655
Epoch  21 Batch   31/53   train_loss = 1.200
Epoch  21 Batch   32/53   train_loss = 0.999
Epoch  21 Batch   33/53   train_loss = 0.970
Epoch  21 Batch   34/53   train_loss = 1.206
Epoch  21 Batch   35/53   train_loss = 1.064
Epoch  21 Batch   36/53   train_loss = 0.802
Epoch  21 Batch   37/53   train_loss = 1.474
Epoch  21 Batch   38/53   train_loss = 1.189
Epoch  21 Batch   39/53   train_loss = 1.067
Epoch  21 Batch   40/53   train_loss = 0.793
Epoch  21 Batch   41/53   train_loss = 1.522
Epoch  21 Batch   42/53   train_loss = 0.944
Epoch  21 Batch   43/53   train_loss = 1.510
Epoch  21 Batch   44/53   train_loss = 1.116
Epoch  21 Batch   45/53   train_loss = 1.043
Epoch  21 Batch   46/53   train_loss = 1.059
Epoch  21 Batch   47/53   train_loss = 1.575
Epoch  21 Batch   48/53   train_loss = 0.947
Epoch  21 Batch   49/53   train_loss = 1.348
Epoch  21 Batch   50/53   train_loss = 1.102
Epoch  21 Batch   51/53   train_loss = 1.055
Epoch  21 Batch   52/53   train_loss = 1.105
Epoch  22 Batch    0/53   train_loss = 0.035
Epoch  22 Batch    1/53   train_loss = 1.230
Epoch  22 Batch    2/53   train_loss = 0.873
Epoch  22 Batch    3/53   train_loss = 0.733
Epoch  22 Batch    4/53   train_loss = 0.757
Epoch  22 Batch    5/53   train_loss = 0.833
Epoch  22 Batch    6/53   train_loss = 0.646
Epoch  22 Batch    7/53   train_loss = 0.840
Epoch  22 Batch    8/53   train_loss = 0.603
Epoch  22 Batch    9/53   train_loss = 0.722
Epoch  22 Batch   10/53   train_loss = 0.668
Epoch  22 Batch   11/53   train_loss = 0.965
Epoch  22 Batch   12/53   train_loss = 0.531
Epoch  22 Batch   13/53   train_loss = 0.945
Epoch  22 Batch   14/53   train_loss = 0.611
Epoch  22 Batch   15/53   train_loss = 0.773
Epoch  22 Batch   16/53   train_loss = 0.717
Epoch  22 Batch   17/53   train_loss = 0.990
Epoch  22 Batch   18/53   train_loss = 0.588
Epoch  22 Batch   19/53   train_loss = 1.091
Epoch  22 Batch   20/53   train_loss = 0.649
Epoch  22 Batch   21/53   train_loss = 0.771
Epoch  22 Batch   22/53   train_loss = 0.794
Epoch  22 Batch   23/53   train_loss = 1.045
Epoch  22 Batch   24/53   train_loss = 0.620
Epoch  22 Batch   25/53   train_loss = 0.945
Epoch  22 Batch   26/53   train_loss = 0.702
Epoch  22 Batch   27/53   train_loss = 0.970
Epoch  22 Batch   28/53   train_loss = 0.753
Epoch  22 Batch   29/53   train_loss = 1.325
Epoch  22 Batch   30/53   train_loss = 0.596
Epoch  22 Batch   31/53   train_loss = 1.137
Epoch  22 Batch   32/53   train_loss = 0.956
Epoch  22 Batch   33/53   train_loss = 0.904
Epoch  22 Batch   34/53   train_loss = 1.136
Epoch  22 Batch   35/53   train_loss = 1.001
Epoch  22 Batch   36/53   train_loss = 0.746
Epoch  22 Batch   37/53   train_loss = 1.364
Epoch  22 Batch   38/53   train_loss = 1.086
Epoch  22 Batch   39/53   train_loss = 0.999
Epoch  22 Batch   40/53   train_loss = 0.711
Epoch  22 Batch   41/53   train_loss = 1.384
Epoch  22 Batch   42/53   train_loss = 0.875
Epoch  22 Batch   43/53   train_loss = 1.392
Epoch  22 Batch   44/53   train_loss = 1.006
Epoch  22 Batch   45/53   train_loss = 0.938
Epoch  22 Batch   46/53   train_loss = 0.997
Epoch  22 Batch   47/53   train_loss = 1.427
Epoch  22 Batch   48/53   train_loss = 0.801
Epoch  22 Batch   49/53   train_loss = 1.196
Epoch  22 Batch   50/53   train_loss = 1.047
Epoch  22 Batch   51/53   train_loss = 0.947
Epoch  22 Batch   52/53   train_loss = 0.965
Epoch  23 Batch    0/53   train_loss = 0.028
Epoch  23 Batch    1/53   train_loss = 1.051
Epoch  23 Batch    2/53   train_loss = 0.791
Epoch  23 Batch    3/53   train_loss = 0.662
Epoch  23 Batch    4/53   train_loss = 0.664
Epoch  23 Batch    5/53   train_loss = 0.721
Epoch  23 Batch    6/53   train_loss = 0.554
Epoch  23 Batch    7/53   train_loss = 0.753
Epoch  23 Batch    8/53   train_loss = 0.533
Epoch  23 Batch    9/53   train_loss = 0.610
Epoch  23 Batch   10/53   train_loss = 0.561
Epoch  23 Batch   11/53   train_loss = 0.841
Epoch  23 Batch   12/53   train_loss = 0.471
Epoch  23 Batch   13/53   train_loss = 0.830
Epoch  23 Batch   14/53   train_loss = 0.497
Epoch  23 Batch   15/53   train_loss = 0.681
Epoch  23 Batch   16/53   train_loss = 0.641
Epoch  23 Batch   17/53   train_loss = 0.879
Epoch  23 Batch   18/53   train_loss = 0.513
Epoch  23 Batch   19/53   train_loss = 1.013
Epoch  23 Batch   20/53   train_loss = 0.600
Epoch  23 Batch   21/53   train_loss = 0.668
Epoch  23 Batch   22/53   train_loss = 0.689
Epoch  23 Batch   23/53   train_loss = 0.961
Epoch  23 Batch   24/53   train_loss = 0.576
Epoch  23 Batch   25/53   train_loss = 0.853
Epoch  23 Batch   26/53   train_loss = 0.616
Epoch  23 Batch   27/53   train_loss = 0.863
Epoch  23 Batch   28/53   train_loss = 0.704
Epoch  23 Batch   29/53   train_loss = 1.203
Epoch  23 Batch   30/53   train_loss = 0.512
Epoch  23 Batch   31/53   train_loss = 1.011
Epoch  23 Batch   32/53   train_loss = 0.877
Epoch  23 Batch   33/53   train_loss = 0.835
Epoch  23 Batch   34/53   train_loss = 1.042
Epoch  23 Batch   35/53   train_loss = 0.900
Epoch  23 Batch   36/53   train_loss = 0.665
Epoch  23 Batch   37/53   train_loss = 1.255
Epoch  23 Batch   38/53   train_loss = 0.990
Epoch  23 Batch   39/53   train_loss = 0.895
Epoch  23 Batch   40/53   train_loss = 0.623
Epoch  23 Batch   41/53   train_loss = 1.291
Epoch  23 Batch   42/53   train_loss = 0.812
Epoch  23 Batch   43/53   train_loss = 1.286
Epoch  23 Batch   44/53   train_loss = 0.923
Epoch  23 Batch   45/53   train_loss = 0.865
Epoch  23 Batch   46/53   train_loss = 0.917
Epoch  23 Batch   47/53   train_loss = 1.336
Epoch  23 Batch   48/53   train_loss = 0.763
Epoch  23 Batch   49/53   train_loss = 1.121
Epoch  23 Batch   50/53   train_loss = 0.930
Epoch  23 Batch   51/53   train_loss = 0.857
Epoch  23 Batch   52/53   train_loss = 0.922
Epoch  24 Batch    0/53   train_loss = 0.029
Epoch  24 Batch    1/53   train_loss = 0.980
Epoch  24 Batch    2/53   train_loss = 0.702
Epoch  24 Batch    3/53   train_loss = 0.584
Epoch  24 Batch    4/53   train_loss = 0.620
Epoch  24 Batch    5/53   train_loss = 0.684
Epoch  24 Batch    6/53   train_loss = 0.494
Epoch  24 Batch    7/53   train_loss = 0.668
Epoch  24 Batch    8/53   train_loss = 0.465
Epoch  24 Batch    9/53   train_loss = 0.571
Epoch  24 Batch   10/53   train_loss = 0.512
Epoch  24 Batch   11/53   train_loss = 0.750
Epoch  24 Batch   12/53   train_loss = 0.413
Epoch  24 Batch   13/53   train_loss = 0.774
Epoch  24 Batch   14/53   train_loss = 0.459
Epoch  24 Batch   15/53   train_loss = 0.597
Epoch  24 Batch   16/53   train_loss = 0.548
Epoch  24 Batch   17/53   train_loss = 0.817
Epoch  24 Batch   18/53   train_loss = 0.470
Epoch  24 Batch   19/53   train_loss = 0.889
Epoch  24 Batch   20/53   train_loss = 0.519
Epoch  24 Batch   21/53   train_loss = 0.612
Epoch  24 Batch   22/53   train_loss = 0.693
Epoch  24 Batch   23/53   train_loss = 0.862
Epoch  24 Batch   24/53   train_loss = 0.490
Epoch  24 Batch   25/53   train_loss = 0.785
Epoch  24 Batch   26/53   train_loss = 0.568
Epoch  24 Batch   27/53   train_loss = 0.815
Epoch  24 Batch   28/53   train_loss = 0.606
Epoch  24 Batch   29/53   train_loss = 1.107
Epoch  24 Batch   30/53   train_loss = 0.502
Epoch  24 Batch   31/53   train_loss = 0.929
Epoch  24 Batch   32/53   train_loss = 0.743
Epoch  24 Batch   33/53   train_loss = 0.740
Epoch  24 Batch   34/53   train_loss = 0.996
Epoch  24 Batch   35/53   train_loss = 0.830
Epoch  24 Batch   36/53   train_loss = 0.596
Epoch  24 Batch   37/53   train_loss = 1.150
Epoch  24 Batch   38/53   train_loss = 0.934
Epoch  24 Batch   39/53   train_loss = 0.799
Epoch  24 Batch   40/53   train_loss = 0.575
Epoch  24 Batch   41/53   train_loss = 1.262
Epoch  24 Batch   42/53   train_loss = 0.751
Epoch  24 Batch   43/53   train_loss = 1.177
Epoch  24 Batch   44/53   train_loss = 0.878
Epoch  24 Batch   45/53   train_loss = 0.853
Epoch  24 Batch   46/53   train_loss = 0.811
Epoch  24 Batch   47/53   train_loss = 1.181
Epoch  24 Batch   48/53   train_loss = 0.708
Epoch  24 Batch   49/53   train_loss = 1.059
Epoch  24 Batch   50/53   train_loss = 0.855
Epoch  24 Batch   51/53   train_loss = 0.752
Epoch  24 Batch   52/53   train_loss = 0.796
Epoch  25 Batch    0/53   train_loss = 0.033
Epoch  25 Batch    1/53   train_loss = 0.907
Epoch  25 Batch    2/53   train_loss = 0.678
Epoch  25 Batch    3/53   train_loss = 0.523
Epoch  25 Batch    4/53   train_loss = 0.548
Epoch  25 Batch    5/53   train_loss = 0.605
Epoch  25 Batch    6/53   train_loss = 0.457
Epoch  25 Batch    7/53   train_loss = 0.634
Epoch  25 Batch    8/53   train_loss = 0.421
Epoch  25 Batch    9/53   train_loss = 0.504
Epoch  25 Batch   10/53   train_loss = 0.465
Epoch  25 Batch   11/53   train_loss = 0.675
Epoch  25 Batch   12/53   train_loss = 0.370
Epoch  25 Batch   13/53   train_loss = 0.708
Epoch  25 Batch   14/53   train_loss = 0.400
Epoch  25 Batch   15/53   train_loss = 0.537
Epoch  25 Batch   16/53   train_loss = 0.485
Epoch  25 Batch   17/53   train_loss = 0.709
Epoch  25 Batch   18/53   train_loss = 0.421
Epoch  25 Batch   19/53   train_loss = 0.828
Epoch  25 Batch   20/53   train_loss = 0.475
Epoch  25 Batch   21/53   train_loss = 0.526
Epoch  25 Batch   22/53   train_loss = 0.548
Epoch  25 Batch   23/53   train_loss = 0.778
Epoch  25 Batch   24/53   train_loss = 0.458
Epoch  25 Batch   25/53   train_loss = 0.719
Epoch  25 Batch   26/53   train_loss = 0.495
Epoch  25 Batch   27/53   train_loss = 0.716
Epoch  25 Batch   28/53   train_loss = 0.567
Epoch  25 Batch   29/53   train_loss = 1.022
Epoch  25 Batch   30/53   train_loss = 0.423
Epoch  25 Batch   31/53   train_loss = 0.824
Epoch  25 Batch   32/53   train_loss = 0.684
Epoch  25 Batch   33/53   train_loss = 0.658
Epoch  25 Batch   34/53   train_loss = 0.867
Epoch  25 Batch   35/53   train_loss = 0.751
Epoch  25 Batch   36/53   train_loss = 0.569
Epoch  25 Batch   37/53   train_loss = 1.047
Epoch  25 Batch   38/53   train_loss = 0.806
Epoch  25 Batch   39/53   train_loss = 0.738
Epoch  25 Batch   40/53   train_loss = 0.548
Epoch  25 Batch   41/53   train_loss = 1.119
Epoch  25 Batch   42/53   train_loss = 0.665
Epoch  25 Batch   43/53   train_loss = 1.151
Epoch  25 Batch   44/53   train_loss = 0.819
Epoch  25 Batch   45/53   train_loss = 0.745
Epoch  25 Batch   46/53   train_loss = 0.751
Epoch  25 Batch   47/53   train_loss = 1.184
Epoch  25 Batch   48/53   train_loss = 0.626
Epoch  25 Batch   49/53   train_loss = 0.912
Epoch  25 Batch   50/53   train_loss = 0.809
Epoch  25 Batch   51/53   train_loss = 0.793
Epoch  25 Batch   52/53   train_loss = 0.780
Epoch  26 Batch    0/53   train_loss = 0.024
Epoch  26 Batch    1/53   train_loss = 0.817
Epoch  26 Batch    2/53   train_loss = 0.635
Epoch  26 Batch    3/53   train_loss = 0.512
Epoch  26 Batch    4/53   train_loss = 0.521
Epoch  26 Batch    5/53   train_loss = 0.543
Epoch  26 Batch    6/53   train_loss = 0.415
Epoch  26 Batch    7/53   train_loss = 0.581
Epoch  26 Batch    8/53   train_loss = 0.397
Epoch  26 Batch    9/53   train_loss = 0.479
Epoch  26 Batch   10/53   train_loss = 0.434
Epoch  26 Batch   11/53   train_loss = 0.643
Epoch  26 Batch   12/53   train_loss = 0.332
Epoch  26 Batch   13/53   train_loss = 0.639
Epoch  26 Batch   14/53   train_loss = 0.363
Epoch  26 Batch   15/53   train_loss = 0.499
Epoch  26 Batch   16/53   train_loss = 0.461
Epoch  26 Batch   17/53   train_loss = 0.661
Epoch  26 Batch   18/53   train_loss = 0.377
Epoch  26 Batch   19/53   train_loss = 0.755
Epoch  26 Batch   20/53   train_loss = 0.452
Epoch  26 Batch   21/53   train_loss = 0.505
Epoch  26 Batch   22/53   train_loss = 0.511
Epoch  26 Batch   23/53   train_loss = 0.721
Epoch  26 Batch   24/53   train_loss = 0.413
Epoch  26 Batch   25/53   train_loss = 0.658
Epoch  26 Batch   26/53   train_loss = 0.475
Epoch  26 Batch   27/53   train_loss = 0.678
Epoch  26 Batch   28/53   train_loss = 0.522
Epoch  26 Batch   29/53   train_loss = 0.940
Epoch  26 Batch   30/53   train_loss = 0.402
Epoch  26 Batch   31/53   train_loss = 0.743
Epoch  26 Batch   32/53   train_loss = 0.636
Epoch  26 Batch   33/53   train_loss = 0.621
Epoch  26 Batch   34/53   train_loss = 0.814
Epoch  26 Batch   35/53   train_loss = 0.666
Epoch  26 Batch   36/53   train_loss = 0.501
Epoch  26 Batch   37/53   train_loss = 1.000
Epoch  26 Batch   38/53   train_loss = 0.765
Epoch  26 Batch   39/53   train_loss = 0.643
Epoch  26 Batch   40/53   train_loss = 0.484
Epoch  26 Batch   41/53   train_loss = 1.054
Epoch  26 Batch   42/53   train_loss = 0.650
Epoch  26 Batch   43/53   train_loss = 0.961
Epoch  26 Batch   44/53   train_loss = 0.741
Epoch  26 Batch   45/53   train_loss = 0.735
Epoch  26 Batch   46/53   train_loss = 0.749
Epoch  26 Batch   47/53   train_loss = 1.022
Epoch  26 Batch   48/53   train_loss = 0.558
Epoch  26 Batch   49/53   train_loss = 0.956
Epoch  26 Batch   50/53   train_loss = 0.799
Epoch  26 Batch   51/53   train_loss = 0.636
Epoch  26 Batch   52/53   train_loss = 0.710
Epoch  27 Batch    0/53   train_loss = 0.026
Epoch  27 Batch    1/53   train_loss = 1.013
Epoch  27 Batch    2/53   train_loss = 0.622
Epoch  27 Batch    3/53   train_loss = 0.433
Epoch  27 Batch    4/53   train_loss = 0.494
Epoch  27 Batch    5/53   train_loss = 0.625
Epoch  27 Batch    6/53   train_loss = 0.468
Epoch  27 Batch    7/53   train_loss = 0.575
Epoch  27 Batch    8/53   train_loss = 0.352
Epoch  27 Batch    9/53   train_loss = 0.442
Epoch  27 Batch   10/53   train_loss = 0.465
Epoch  27 Batch   11/53   train_loss = 0.688
Epoch  27 Batch   12/53   train_loss = 0.344
Epoch  27 Batch   13/53   train_loss = 0.606
Epoch  27 Batch   14/53   train_loss = 0.341
Epoch  27 Batch   15/53   train_loss = 0.484
Epoch  27 Batch   16/53   train_loss = 0.475
Epoch  27 Batch   17/53   train_loss = 0.655
Epoch  27 Batch   18/53   train_loss = 0.354
Epoch  27 Batch   19/53   train_loss = 0.693
Epoch  27 Batch   20/53   train_loss = 0.436
Epoch  27 Batch   21/53   train_loss = 0.515
Epoch  27 Batch   22/53   train_loss = 0.492
Epoch  27 Batch   23/53   train_loss = 0.682
Epoch  27 Batch   24/53   train_loss = 0.379
Epoch  27 Batch   25/53   train_loss = 0.636
Epoch  27 Batch   26/53   train_loss = 0.445
Epoch  27 Batch   27/53   train_loss = 0.630
Epoch  27 Batch   28/53   train_loss = 0.481
Epoch  27 Batch   29/53   train_loss = 0.909
Epoch  27 Batch   30/53   train_loss = 0.373
Epoch  27 Batch   31/53   train_loss = 0.705
Epoch  27 Batch   32/53   train_loss = 0.594
Epoch  27 Batch   33/53   train_loss = 0.581
Epoch  27 Batch   34/53   train_loss = 0.776
Epoch  27 Batch   35/53   train_loss = 0.645
Epoch  27 Batch   36/53   train_loss = 0.477
Epoch  27 Batch   37/53   train_loss = 0.896
Epoch  27 Batch   38/53   train_loss = 0.693
Epoch  27 Batch   39/53   train_loss = 0.629
Epoch  27 Batch   40/53   train_loss = 0.429
Epoch  27 Batch   41/53   train_loss = 0.943
Epoch  27 Batch   42/53   train_loss = 0.586
Epoch  27 Batch   43/53   train_loss = 0.907
Epoch  27 Batch   44/53   train_loss = 0.704
Epoch  27 Batch   45/53   train_loss = 0.643
Epoch  27 Batch   46/53   train_loss = 0.643
Epoch  27 Batch   47/53   train_loss = 0.929
Epoch  27 Batch   48/53   train_loss = 0.522
Epoch  27 Batch   49/53   train_loss = 0.792
Epoch  27 Batch   50/53   train_loss = 0.654
Epoch  27 Batch   51/53   train_loss = 0.565
Epoch  27 Batch   52/53   train_loss = 0.630
Epoch  28 Batch    0/53   train_loss = 0.022
Epoch  28 Batch    1/53   train_loss = 0.682
Epoch  28 Batch    2/53   train_loss = 0.491
Epoch  28 Batch    3/53   train_loss = 0.386
Epoch  28 Batch    4/53   train_loss = 0.422
Epoch  28 Batch    5/53   train_loss = 0.471
Epoch  28 Batch    6/53   train_loss = 0.349
Epoch  28 Batch    7/53   train_loss = 0.481
Epoch  28 Batch    8/53   train_loss = 0.304
Epoch  28 Batch    9/53   train_loss = 0.384
Epoch  28 Batch   10/53   train_loss = 0.377
Epoch  28 Batch   11/53   train_loss = 0.526
Epoch  28 Batch   12/53   train_loss = 0.282
Epoch  28 Batch   13/53   train_loss = 0.545
Epoch  28 Batch   14/53   train_loss = 0.294
Epoch  28 Batch   15/53   train_loss = 0.421
Epoch  28 Batch   16/53   train_loss = 0.347
Epoch  28 Batch   17/53   train_loss = 0.540
Epoch  28 Batch   18/53   train_loss = 0.307
Epoch  28 Batch   19/53   train_loss = 0.623
Epoch  28 Batch   20/53   train_loss = 0.368
Epoch  28 Batch   21/53   train_loss = 0.403
Epoch  28 Batch   22/53   train_loss = 0.410
Epoch  28 Batch   23/53   train_loss = 0.590
Epoch  28 Batch   24/53   train_loss = 0.340
Epoch  28 Batch   25/53   train_loss = 0.552
Epoch  28 Batch   26/53   train_loss = 0.380
Epoch  28 Batch   27/53   train_loss = 0.550
Epoch  28 Batch   28/53   train_loss = 0.425
Epoch  28 Batch   29/53   train_loss = 0.811
Epoch  28 Batch   30/53   train_loss = 0.325
Epoch  28 Batch   31/53   train_loss = 0.623
Epoch  28 Batch   32/53   train_loss = 0.516
Epoch  28 Batch   33/53   train_loss = 0.502
Epoch  28 Batch   34/53   train_loss = 0.686
Epoch  28 Batch   35/53   train_loss = 0.584
Epoch  28 Batch   36/53   train_loss = 0.425
Epoch  28 Batch   37/53   train_loss = 0.800
Epoch  28 Batch   38/53   train_loss = 0.609
Epoch  28 Batch   39/53   train_loss = 0.551
Epoch  28 Batch   40/53   train_loss = 0.372
Epoch  28 Batch   41/53   train_loss = 0.868
Epoch  28 Batch   42/53   train_loss = 0.520
Epoch  28 Batch   43/53   train_loss = 0.826
Epoch  28 Batch   44/53   train_loss = 0.619
Epoch  28 Batch   45/53   train_loss = 0.563
Epoch  28 Batch   46/53   train_loss = 0.555
Epoch  28 Batch   47/53   train_loss = 0.851
Epoch  28 Batch   48/53   train_loss = 0.468
Epoch  28 Batch   49/53   train_loss = 0.678
Epoch  28 Batch   50/53   train_loss = 0.599
Epoch  28 Batch   51/53   train_loss = 0.509
Epoch  28 Batch   52/53   train_loss = 0.581
Epoch  29 Batch    0/53   train_loss = 0.024
Epoch  29 Batch    1/53   train_loss = 0.600
Epoch  29 Batch    2/53   train_loss = 0.438
Epoch  29 Batch    3/53   train_loss = 0.327
Epoch  29 Batch    4/53   train_loss = 0.385
Epoch  29 Batch    5/53   train_loss = 0.409
Epoch  29 Batch    6/53   train_loss = 0.319
Epoch  29 Batch    7/53   train_loss = 0.425
Epoch  29 Batch    8/53   train_loss = 0.280
Epoch  29 Batch    9/53   train_loss = 0.345
Epoch  29 Batch   10/53   train_loss = 0.343
Epoch  29 Batch   11/53   train_loss = 0.466
Epoch  29 Batch   12/53   train_loss = 0.247
Epoch  29 Batch   13/53   train_loss = 0.482
Epoch  29 Batch   14/53   train_loss = 0.259
Epoch  29 Batch   15/53   train_loss = 0.368
Epoch  29 Batch   16/53   train_loss = 0.317
Epoch  29 Batch   17/53   train_loss = 0.486
Epoch  29 Batch   18/53   train_loss = 0.278
Epoch  29 Batch   19/53   train_loss = 0.556
Epoch  29 Batch   20/53   train_loss = 0.327
Epoch  29 Batch   21/53   train_loss = 0.360
Epoch  29 Batch   22/53   train_loss = 0.370
Epoch  29 Batch   23/53   train_loss = 0.520
Epoch  29 Batch   24/53   train_loss = 0.307
Epoch  29 Batch   25/53   train_loss = 0.491
Epoch  29 Batch   26/53   train_loss = 0.332
Epoch  29 Batch   27/53   train_loss = 0.496
Epoch  29 Batch   28/53   train_loss = 0.387
Epoch  29 Batch   29/53   train_loss = 0.733
Epoch  29 Batch   30/53   train_loss = 0.284
Epoch  29 Batch   31/53   train_loss = 0.532
Epoch  29 Batch   32/53   train_loss = 0.458
Epoch  29 Batch   33/53   train_loss = 0.455
Epoch  29 Batch   34/53   train_loss = 0.615
Epoch  29 Batch   35/53   train_loss = 0.503
Epoch  29 Batch   36/53   train_loss = 0.381
Epoch  29 Batch   37/53   train_loss = 0.742
Epoch  29 Batch   38/53   train_loss = 0.552
Epoch  29 Batch   39/53   train_loss = 0.474
Epoch  29 Batch   40/53   train_loss = 0.330
Epoch  29 Batch   41/53   train_loss = 0.796
Epoch  29 Batch   42/53   train_loss = 0.483
Epoch  29 Batch   43/53   train_loss = 0.715
Epoch  29 Batch   44/53   train_loss = 0.571
Epoch  29 Batch   45/53   train_loss = 0.530
Epoch  29 Batch   46/53   train_loss = 0.523
Epoch  29 Batch   47/53   train_loss = 0.732
Epoch  29 Batch   48/53   train_loss = 0.430
Epoch  29 Batch   49/53   train_loss = 0.664
Epoch  29 Batch   50/53   train_loss = 0.566
Epoch  29 Batch   51/53   train_loss = 0.459
Epoch  29 Batch   52/53   train_loss = 0.516
Model Trained and Saved
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 23.5938px; left: 324.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 46px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 319px; top: 18px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">#### Save Parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Save <span class="cm-comment">`seq_length`</span> and <span class="cm-comment">`save_dir`</span> for generating a new TV script.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 76px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h4 id="Save-Parameters">Save Parameters<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Save-Parameters">¶</a></h4>
<p>Save <code>seq_length</code> and <code>save_dir</code> for generating a new TV script.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[199]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.5938px; left: 173.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 355.797px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 168px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Save parameters for checkpoint</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">helper</span>.<span class="cm-property">save_params</span>((<span class="cm-variable">seq_length</span>, <span class="cm-variable">save_dir</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 22px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Checkpoint</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 33px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Checkpoint">Checkpoint<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Checkpoint">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[200]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107.594px; left: 282.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 574px; margin-bottom: 0px; border-right-width: 30px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 277px; top: 102px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">helper</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">problem_unittests</span> <span class="cm-keyword">as</span> <span class="cm-variable">tests</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">_</span>, <span class="cm-variable">vocab_to_int</span>, <span class="cm-variable">int_to_vocab</span>, <span class="cm-variable">token_dict</span> = <span class="cm-variable">helper</span>.<span class="cm-property">load_preprocess</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">seq_length</span>, <span class="cm-variable">load_dir</span> = <span class="cm-variable">helper</span>.<span class="cm-property">load_params</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 211px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 146.594px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 186px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 141px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Implement Generate Functions</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Get Tensors</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Get tensors from <span class="cm-comment">`loaded_graph`</span> using the function <span class="cm-link">[</span><span class="cm-link cm-comment">`get_tensor_by_name()`</span><span class="cm-link">]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/Graph#get_tensor_by_name)</span>.  Get the tensors using the following names:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- "input:0"</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- "initial_state:0"</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- "final_state:0"</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- "probs:0"</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Return the tensors in the following tuple <span class="cm-comment">`(InputTensor, InitialStateTensor, FinalStateTensor, ProbsTensor)`</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 186px;"></div><div class="CodeMirror-gutters" style="display: none; height: 216px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Implement-Generate-Functions">Implement Generate Functions<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Implement-Generate-Functions">¶</a></h2>
<h3 id="Get-Tensors">Get Tensors<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Get-Tensors">¶</a></h3>
<p>Get tensors from <code>loaded_graph</code> using the function <a href="https://www.tensorflow.org/api_docs/python/tf/Graph#get_tensor_by_name" target="_blank"><code>get_tensor_by_name()</code></a>.  Get the tensors using the following names:</p>
<ul>
<li>"input:0"</li>
<li>"initial_state:0"</li>
<li>"final_state:0"</li>
<li>"probs:0"</li>
</ul>
<p>Return the tensors in the following tuple <code>(InputTensor, InitialStateTensor, FinalStateTensor, ProbsTensor)</code> </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[201]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 141.594px; left: 274.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 733.906px; margin-bottom: 0px; border-right-width: 30px; min-height: 317px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 269px; top: 136px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">get_tensors</span>(<span class="cm-variable">loaded_graph</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Get input, initial state, final state, and probabilities tensor from &lt;loaded_graph&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param loaded_graph: TensorFlow graph loaded from file</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: Tuple (InputTensor, InitialStateTensor, FinalStateTensor, ProbsTensor)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">InputTensor</span> = <span class="cm-variable">loaded_graph</span>.<span class="cm-property">get_tensor_by_name</span>(<span class="cm-string">"input:0"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">InitialStateTensor</span> = <span class="cm-variable">loaded_graph</span>.<span class="cm-property">get_tensor_by_name</span>(<span class="cm-string">"initial_state:0"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">FinalStateTensor</span> = <span class="cm-variable">loaded_graph</span>.<span class="cm-property">get_tensor_by_name</span>(<span class="cm-string">"final_state:0"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">ProbsTensor</span> = <span class="cm-variable">loaded_graph</span>.<span class="cm-property">get_tensor_by_name</span>(<span class="cm-string">"probs:0"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">InputTensor</span>, <span class="cm-variable">InitialStateTensor</span>, <span class="cm-variable">FinalStateTensor</span>, <span class="cm-variable">ProbsTensor</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_get_tensors</span>(<span class="cm-variable">get_tensors</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 317px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 47px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Choose Word</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Implement the <span class="cm-comment">`pick_word()`</span> function to select the next word using <span class="cm-comment">`probabilities`</span>.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 47px;"></div><div class="CodeMirror-gutters" style="display: none; height: 77px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Choose-Word">Choose Word<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Choose-Word">¶</a></h3>
<p>Implement the <code>pick_word()</code> function to select the next word using <code>probabilities</code>.</p>
</div></div></div><div class="cell code_cell rendered selected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[202]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 260.594px; left: 291.188px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 700px; margin-bottom: 0px; border-right-width: 30px; min-height: 368px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 285.594px; top: 255px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">pick_word</span>(<span class="cm-variable">probabilities</span>, <span class="cm-variable">int_to_vocab</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Pick the next word in the generated text</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param probabilities: Probabilites of the next word</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :param int_to_vocab: Dictionary of word ids as the keys and words as the values</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    :return: String of the predicted word</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># TODO: Implement Function</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">prob_5_max</span> = <span class="cm-variable">probabilities</span>.<span class="cm-property">argsort</span>()[<span class="cm-operator">-</span><span class="cm-number">5</span>:] <span class="cm-comment"># taking top 5 prob</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">choice</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>(<span class="cm-variable">prob_5_max</span>, <span class="cm-number">1</span>) <span class="cm-comment"># choosing randomly from top 5</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">ix</span>, <span class="cm-variable">prob</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">probabilities</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">ix</span> == <span class="cm-variable">choice</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">next_word</span> = <span class="cm-variable">ix</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-keyword">break</span> <span class="cm-comment"># take the first word with that probability</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">int_to_vocab</span><span class=" CodeMirror-matchingbracket">[</span><span class="cm-variable">next_word</span><span class=" CodeMirror-matchingbracket">]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">tests</span>.<span class="cm-property">test_pick_word</span>(<span class="cm-variable">pick_word</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 398px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Tests Passed
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 65px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Generate TV Script</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This will generate the TV script for you.  Set <span class="cm-comment">`gen_length`</span> to the length of TV script you want to generate.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 65px;"></div><div class="CodeMirror-gutters" style="display: none; height: 95px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Generate-TV-Script">Generate TV Script<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Generate-TV-Script">¶</a></h2>
<p>This will generate the TV script for you.  Set <code>gen_length</code> to the length of TV script you want to generate.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[203]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.594px; left: 97.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 691.75px; margin-bottom: 0px; border-right-width: 30px; min-height: 759px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 92px; top: 153px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gen_length</span> = <span class="cm-number">200</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># homer_simpson, moe_szyslak, or Barney_Gumble</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">prime_word</span> = <span class="cm-string">'moe_szyslak'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">DON'T MODIFY ANYTHING IN THIS CELL THAT IS BELOW THIS LINE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">loaded_graph</span> = <span class="cm-variable">tf</span>.<span class="cm-property">Graph</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">tf</span>.<span class="cm-property">Session</span>(<span class="cm-variable">graph</span>=<span class="cm-variable">loaded_graph</span>) <span class="cm-keyword">as</span> <span class="cm-variable">sess</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Load saved model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loader</span> = <span class="cm-variable">tf</span>.<span class="cm-property">train</span>.<span class="cm-property">import_meta_graph</span>(<span class="cm-variable">load_dir</span> <span class="cm-operator">+</span> <span class="cm-string">'.meta'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">loader</span>.<span class="cm-property">restore</span>(<span class="cm-variable">sess</span>, <span class="cm-variable">load_dir</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Get Tensors from loaded model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">input_text</span>, <span class="cm-variable">initial_state</span>, <span class="cm-variable">final_state</span>, <span class="cm-variable">probs</span> = <span class="cm-variable">get_tensors</span>(<span class="cm-variable">loaded_graph</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Sentences generation setup</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gen_sentences</span> = [<span class="cm-variable">prime_word</span> <span class="cm-operator">+</span> <span class="cm-string">':'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">prev_state</span> = <span class="cm-variable">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable">initial_state</span>, {<span class="cm-variable">input_text</span>: <span class="cm-variable">np</span>.<span class="cm-property">array</span>([[<span class="cm-number">1</span>]])})</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Generate sentences</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">n</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">gen_length</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Dynamic Input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dyn_input</span> = [[<span class="cm-variable">vocab_to_int</span>[<span class="cm-variable">word</span>] <span class="cm-keyword">for</span> <span class="cm-variable">word</span> <span class="cm-keyword">in</span> <span class="cm-variable">gen_sentences</span>[<span class="cm-operator">-</span><span class="cm-variable">seq_length</span>:]]]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">dyn_seq_length</span> = <span class="cm-builtin">len</span>(<span class="cm-variable">dyn_input</span>[<span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Get Prediction</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">probabilities</span>, <span class="cm-variable">prev_state</span> = <span class="cm-variable">sess</span>.<span class="cm-property">run</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            [<span class="cm-variable">probs</span>, <span class="cm-variable">final_state</span>],</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            {<span class="cm-variable">input_text</span>: <span class="cm-variable">dyn_input</span>, <span class="cm-variable">initial_state</span>: <span class="cm-variable">prev_state</span>})</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">pred_word</span> = <span class="cm-variable">pick_word</span>(<span class="cm-variable">probabilities</span>[<span class="cm-variable">dyn_seq_length</span><span class="cm-operator">-</span><span class="cm-number">1</span>], <span class="cm-variable">int_to_vocab</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">gen_sentences</span>.<span class="cm-property">append</span>(<span class="cm-variable">pred_word</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Remove tokens</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tv_script</span> = <span class="cm-string">' '</span>.<span class="cm-property">join</span>(<span class="cm-variable">gen_sentences</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">key</span>, <span class="cm-variable">token</span> <span class="cm-keyword">in</span> <span class="cm-variable">token_dict</span>.<span class="cm-property">items</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">ending</span> = <span class="cm-string">' '</span> <span class="cm-keyword">if</span> <span class="cm-variable">key</span> <span class="cm-keyword">in</span> [<span class="cm-string">'\n'</span>, <span class="cm-string">'('</span>, <span class="cm-string">'"'</span>] <span class="cm-keyword">else</span> <span class="cm-string">''</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">tv_script</span> = <span class="cm-variable">tv_script</span>.<span class="cm-property">replace</span>(<span class="cm-string">' '</span> <span class="cm-operator">+</span> <span class="cm-variable">token</span>.<span class="cm-property">lower</span>(), <span class="cm-variable">key</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tv_script</span> = <span class="cm-variable">tv_script</span>.<span class="cm-property">replace</span>(<span class="cm-string">'\n '</span>, <span class="cm-string">'\n'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">tv_script</span> = <span class="cm-variable">tv_script</span>.<span class="cm-property">replace</span>(<span class="cm-string">'( '</span>, <span class="cm-string">'('</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">tv_script</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 759px;"></div><div class="CodeMirror-gutters" style="display: none; height: 789px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>moe_szyslak: hey it's just gettin' meet this to gums! now to say, everybody, i'm see ya to give to shows of flush-town that bart?
edna_krabappel-flanders: moe if i'm just kiddin' you?(thinks) yeah! so guys! what would you come of make me your dad this this blue place a friend, homer? so good that, it was this, you for a buffalo store with a hate kid. and c'mon he's kick-- pick of the archaeologist like was over here.(changing, when marge to call that in to guy and our woodchucks to get out with a middle to have to thirty big thing.
homer_simpson: so that was all turn to be. anyway too we had to tv! human buddy. uh.
moe_szyslak: well dice and ya know what i need to make this prize, huh no is i have to see ya to be porn feet / well?"
c a realizing and the pool na person what the", you won't got us to learn for" with short(into

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 208px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 22px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># The TV Script is Nonsensical</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">It's ok if the TV script doesn't make any sense.  We trained on less than a megabyte of text.  In order to get good results, you'll have to use a smaller vocabulary or get more data.  Luckly there's more data!  As we mentioned in the begging of this project, this is a subset of <span class="cm-link">[another dataset]</span><span class="cm-string cm-url">(https://www.kaggle.com/wcukierski/the-simpsons-by-the-data)</span>.  We didn't have you train on all the data, because that would take too long.  However, you are free to train your neural network on all the data.  After you complete the project, of course.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Submitting This Project</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">When submitting this project, make sure to run all the cells before saving the notebook. Save the notebook file as "dlnd_tv_script_generation.ipynb" and save it as a HTML file under "File" -&gt; "Download as". Include the "helper.py" and "problem_unittests.py" files in your submission.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 238px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="The-TV-Script-is-Nonsensical">The TV Script is Nonsensical<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#The-TV-Script-is-Nonsensical">¶</a></h1>
<p>It's ok if the TV script doesn't make any sense.  We trained on less than a megabyte of text.  In order to get good results, you'll have to use a smaller vocabulary or get more data.  Luckly there's more data!  As we mentioned in the begging of this project, this is a subset of <a href="https://www.kaggle.com/wcukierski/the-simpsons-by-the-data" target="_blank">another dataset</a>.  We didn't have you train on all the data, because that would take too long.  However, you are free to train your neural network on all the data.  After you complete the project, of course.</p>
<h1 id="Submitting-This-Project">Submitting This Project<a class="anchor-link" href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#Submitting-This-Project">¶</a></h1>
<p>When submitting this project, make sure to run all the cells before saving the notebook. Save the notebook file as "dlnd_tv_script_generation.ipynb" and save it as a HTML file under "File" -&gt; "Download as". Include the "helper.py" and "problem_unittests.py" files in your submission.</p>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="http://localhost:8888/notebooks/GitHub/deep-learning/deep-learning/tv-script-generation/dlnd_tv_script_generation.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"sys_platform": "darwin", "platform": "Darwin-16.3.0-x86_64-i386-64bit", "commit_source": "", "default_encoding": "UTF-8", "commit_hash": "", "sys_executable": "/Users/macky123/anaconda/envs/tensorflow/bin/python", "notebook_version": "4.3.1", "sys_version": "3.5.2 |Continuum Analytics, Inc.| (default, Jul  2 2016, 17:52:12) \n[GCC 4.2.1 Compatible Apple LLVM 4.2 (clang-425.0.28)]", "os_name": "posix", "notebook_path": "/Users/macky123/anaconda/envs/tensorflow/lib/python3.5/site-packages/notebook"};
</script>

<script src="./dlnd_tv_script_generation_files/encoding.js" charset="utf-8"></script>


    <script src="./dlnd_tv_script_generation_files/main.min.js" type="text/javascript" charset="utf-8"></script>






<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal;"></div></div></body></html>